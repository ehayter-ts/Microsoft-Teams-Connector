{"version":3,"file":"run.js","sources":["../src/index.ts","../src/run.ts"],"sourcesContent":["import '@k2oss/k2-broker-core';\r\n\r\nmetadata = {\r\n    systemName: \"MSTeamsJSSP\",\r\n    displayName: \"Microsoft Teams Connector\",\r\n    description: \"A connector for Microsoft Teams\"\r\n};\r\n\r\n// Constants\r\nconst baseUriEndpoint = \"https://graph.microsoft.com/v1.0\";\r\nconst baseUriEndpointBeta = \"https://graph.microsoft.com/beta\";\r\n\r\n//\r\n// Objects\r\n\r\nconst Team = \"team\";\r\nconst Channel = \"channel\";\r\nconst Tab = \"tab\";\r\nconst App = \"app\";\r\nconst Token = \"token\";\r\nconst Drive = \"drive\";\r\nconst Site = \"site\";\r\n\r\n//\r\n// Team\r\nconst TeamId = \"id\";\r\nconst TeamWeburl = \"weburl\";\r\nconst TeamDisplayName = \"displayName\";\r\nconst TeamCreationDate = \"creationDate\"\r\nconst TeamDescription = \"description\";\r\nconst TeamEmail = \"email\";\r\nconst TeamMailEnabled = \"mailEnabled\";\r\nconst TeamMailNickname = \"mailNickname\";\r\nconst TeamArchiveStatus = \"archiveStatus\";\r\nconst TeamOperationId = \"operationId\";\r\nconst TeamOperationType = \"operationType\";\r\nconst TeamLastActionDate = \"lastActionDate\";\r\nconst TeamAttemptsCount = \"attemptsCount\";\r\nconst TeamTargetResourceId = \"targetResourceId\";\r\nconst TeamTargetResourceLocation = \"targetResourceLocation\";\r\nconst TeamArchiveError = \"archiveError\";\r\nconst TeamUserPrincipalName = \"userPrincipalName\";\r\nconst TeamResourceProvisioningOptions = \"resourceProvisioningOptions\";\r\nconst TeamIsArchived = \"isArchived\";\r\nconst TeamIsSuccessful = \"isSuccessful\";\r\nconst TeamRequestStatusUrl = \"requestStatusUrl\";\r\nconst TeamMsAllowCreateUpdateChannels = \"msAllowCreateUpdateChannels\";\r\nconst TeamMsAllowDeleteChannels = \"msAllowDeleteChannels\";\r\nconst TeamMsAllowAddRemoveApps = \"msAllowAddRemoveApps\";\r\nconst TeamMsAllowCreateUpdateRemoveTabs = \"msAllowCreateUpdateRemoveTabs\";\r\nconst TeamMsAllowCreateUpdateRemoveConnectors = \"msAllowCreateUpdateRemoveConnectors\";\r\nconst TeamGsAllowCreateUpdateChannels = \"gsAllowCreateUpdateChannels\";\r\nconst TeamGsAllowDeleteChannels = \"gsAllowDeleteChannels\";\r\nconst TeamMsgAllowUserEditMessages = \"msgsAllowUserEditMessages\";\r\nconst TeamMsgAllowUserDeleteMessages = \"msgsAllowUserDeleteMessages\";\r\nconst TeamMsgAllowOwnerDeleteMessages = \"msgsAllowOwnerDeleteMessages\";\r\nconst TeamMsgAllowTeamMentions = \"msgsAllowTeamMentions\";\r\nconst TeamMsgAllowChannelMentions = \"msgsAllowChannelMentions\";\r\nconst TeamFsAllowGiphy = \"fsAllowGiphy\";\r\nconst TeamFsAllowStickersAndMemes = \"fsAllowStickersAndMemes\";\r\nconst TeamFsAllowCustomMemes = \"fsAllowCustomMemes\";\r\n\r\nconst TeamGet = \"get\";\r\nconst TeamCreate = \"create\";\r\nconst TeamAdd = \"add\"; //  not used\r\nconst TeamArchive = \"archive\";\r\nconst TeamUnarchive = \"unarchive\";\r\nconst TeamCheckStatus = \"checkStatus\"; // not used\r\nconst TeamAddMember = \"addMember\";\r\nconst TeamRemoveMember = \"removeMember\";\r\nconst TeamUpdate = \"update\";\r\nconst TeamClone = \"clone\";\r\nconst TeamAddOwner = \"addOwner\";\r\nconst TeamList = \"list\";\r\nconst TeamMyTeamsList = \"myTeamsList\";\r\n\r\nconst TeamArchiveOperationUrl = \"archiveOperationUrl\";\r\nconst TeamAddAsMemberAlso = \"addAsMemberAlso\"; //  not used\r\nconst TeamDisplayNameStartsWith = \"displayNameStartsWith\";\r\nconst TeamUserId = \"userId\";\r\n\r\n//\r\n// Channel\r\nconst ChannelId = \"id\";\r\nconst ChannelDisplayName = \"displayName\";\r\nconst ChannelDescription = \"description\";\r\nconst ChannelEmail = \"email\";\r\nconst ChannelWeburl = \"weburl\";\r\nconst ChannelIsSuccessful = \"isSuccessful\";\r\nconst ChannelTeamId = \"teamId\";\r\nconst ChannelMessageSubject = \"messageSubject\";\r\nconst ChannelMessageBody = \"messageBody\";\r\nconst ChannelMessageId = \"messageId\";\r\nconst ChannelMessageIsImportant = \"messageIsImportant\";\r\nconst MembershipType = \"membershipType\";\r\nconst ChannelUserPrincipalName = \"userPrincipalName\";\r\nconst ChannelUserId = \"userId\";\r\nconst ChannelUserName = \"Name\";\r\nconst ChannelMessageUser = \"messageUser\";\r\nconst ChannelMessageDate = \"messageDate\";\r\nconst ChannelDriveId = \"channelDriveId\";\r\nconst ChannelDriveUrl = \"channelDriveUrl\";\r\nconst ChannelUserMembershipId = \"membershipId\";\r\n\r\nconst ChannelGet = \"get\";\r\nconst ChannelList = \"list\";\r\nconst ChannelCreate = \"create\";\r\nconst ChannelDelete = \"delete\";\r\nconst ChannelUpdate = \"update\";\r\nconst ChannelSendMessage = \"sendMessage\";\r\nconst ChannelSendAdaptiveCard = \"sendAdaptiveCard\";\r\nconst ChannelReplyMessage = \"replyMessage\";\r\nconst ChannelAddMember = \"addMember\";\r\nconst ChannelMessages = \"getMessages\";\r\nconst ChannelGetDrive = \"getDrive\";\r\nconst ChannelMembers = \"getChannelMembers\";\r\nconst ChannelRemoveMember = \"removeMember\";\r\n\r\n\r\n//\r\n// Tab\r\nconst TabId = \"id\";\r\nconst TabDisplayName = \"displayName\";\r\nconst TabWeburl = \"weburl\";\r\nconst TabConfigEntityId = \"configEntityId\";\r\nconst TabConfigContentUrl = \"configContentUrl\";\r\nconst TabConfigWebsiteUrl = \"configWebsiteUrl\";\r\nconst TabConfigRemoveUrl = \"configRemoveUrl\";\r\nconst TabTeamsAppAppId = \"teamsAppAppId\";\r\nconst TabTeamsAppExternalId = \"teamsAppExternalId\";\r\nconst TabTeamsAppAppDisplayName = \"teamsAppAppDisplayName\";\r\nconst TabTeamsAppDistMethod = \"teamsAppDistMethod\";\r\nconst TabSortOrderIndex = \"sortOrderIndex\";\r\nconst TabIsSuccessful = \"isSuccessful\";\r\nconst TabTeamId = \"teamId\";\r\nconst TabChannelId = \"channelId\";\r\n\r\nconst TabGet = \"get\";\r\nconst TabList = \"list\";\r\nconst TabCreateWordTab = \"createWordTab\";\r\nconst TabCreateExcelTab = \"createExcelTab\";\r\nconst TabCreatePowerPointTab = \"createPowerPointTab\";\r\nconst TabCreatePdfTab = \"createPdfTab\";\r\nconst TabCreateOneNoteTab = \"createOneNoteTab\";\r\nconst TabCreatePlannerTab = \"createPlannerTab\";\r\nconst TabCreateSharePointTab = \"createSharePointTab\";\r\nconst TabCreateMsFormsTab = \"createMsFormsTab\";\r\nconst TabCreateMsStreamTab = \"createStreamTab\";\r\nconst TabCreateWebsiteTab = \"createWebsiteTab\";\r\nconst TabCreateWikiTab = \"createWikiTab\";\r\nconst TabCreatePowerBiTab = \"createPowerBiTab\";\r\nconst TabCreateDocumentLibraryTab = \"createDocumentLibraryTab\";\r\nconst TabCreateCustomTab = \"createCustomTab\";\r\nconst TabDelete = \"delete\";\r\nconst TabUpdate = \"update\";\r\n\r\n//\r\n// App\r\nconst AppId = \"id\";\r\nconst AppTeamId = \"teamId\";\r\nconst AppDisplayName = \"displayName\";\r\nconst AppVersion = \"version\";\r\nconst AppTeamAppDefinitionId = \"teamsAppDefinitionId\";\r\nconst AppTeamsAppId = \"teamsAppId\";\r\n\r\nconst AppList = \"list\";\r\n\r\n//\r\n// Token\r\nconst TokenLifetime = \"tokenLifeTime\";\r\nconst TokenPolicyDisplayName = \"displayName\";\r\nconst TokenOrganizationDefault = \"isOrganizationDefault\";\r\nconst TokenUpdateSuccess = \"updateSuccess\";\r\n\r\nconst TokenPolicySet = \"setToken\";\r\n\r\n//\r\n//Drive\r\nconst DriveId = \"driveId\";\r\nconst DriveRelativePath = \"drivePath\";\r\nconst DriveChildId = \"driveChildId\";\r\nconst DriveChildWebUrl = \"driveChildWebUrl\";\r\nconst DriveChildDownloadUrl = \"driveChildDownloadUrl\";\r\nconst DriveChildFileName = \"driveChildFileName\";\r\nconst DriveChildFolderName = \"driveChildFolderName\";\r\nconst DriveChildFileCreated = \"driveChildFileCreatedDate\";\r\nconst DriveChildFileCreatedBy = \"driveChildFileCreatedBy\";\r\nconst DriveChildFileType = \"driveChildFileType\";\r\n\r\nconst DriveGetRootChildren = \"driveGetRootChildren\";\r\n\r\n//\r\n//Site\r\nconst SiteRelativePath = \"siteRelativePath\";\r\nconst SiteListId = \"listId\";\r\nconst SiteListName = \"listName\";\r\nconst SiteListDisplayName = \"listDisplayName\";\r\n\r\nconst SiteGetLists = \"getSiteLists\";\r\n\r\n//OnDescribe\r\nondescribe = function () {\r\n    postSchema({\r\n\r\n        objects: {\r\n            [Team]: {\r\n                displayName: \"Team\",\r\n                description: \"Team\",\r\n                properties: {\r\n                    [TeamId]: {\r\n                        displayName: \"Team Id\",\r\n                        type: \"string\"\r\n                    },\r\n                    [TeamWeburl]: {\r\n                        displayName: \"Web Url\",\r\n                        type: \"string\"\r\n                    },\r\n                    [TeamDisplayName]: {\r\n                        displayName: \"Display Name\",\r\n                        type: \"string\"\r\n                    },\r\n                    [TeamCreationDate]: {\r\n                        displayName: \"Created On\",\r\n                        type: \"string\"\r\n                    },\r\n                    [TeamDescription]: {\r\n                        displayName: \"Description\",\r\n                        type: \"string\"\r\n                    },\r\n                    [TeamEmail]: {\r\n                        displayName: \"Email\",\r\n                        type: \"string\"\r\n                    },\r\n                    [TeamMailEnabled]: {\r\n                        displayName: \"Mail Enabled\",\r\n                        type: \"boolean\"\r\n                    },\r\n                    [TeamMailNickname]: {\r\n                        displayName: \"Mail Nickname\",\r\n                        type: \"string\"\r\n                    },\r\n                    [TeamArchiveStatus]: {\r\n                        displayName: \"Archive Status\",\r\n                        type: \"string\"\r\n                    },\r\n                    [TeamOperationId]: {\r\n                        displayName: \"Operation Id\",\r\n                        type: \"string\"\r\n                    },\r\n                    [TeamOperationType]: {\r\n                        displayName: \"Operation Type\",\r\n                        type: \"string\"\r\n                    },\r\n                    [TeamLastActionDate]: {\r\n                        displayName: \"Last Action Date\",\r\n                        type: \"string\"\r\n                    },\r\n                    [TeamAttemptsCount]: {\r\n                        displayName: \"Attempts Count\",\r\n                        type: \"string\"\r\n                    },\r\n                    [TeamTargetResourceId]: {\r\n                        displayName: \"Target Resource Id\",\r\n                        type: \"string\"\r\n                    },\r\n                    [TeamTargetResourceLocation]: {\r\n                        displayName: \"Target Resource Location\",\r\n                        type: \"string\"\r\n                    },\r\n                    [TeamArchiveError]: {\r\n                        displayName: \"Error\",\r\n                        type: \"string\"\r\n                    },\r\n                    [TeamUserPrincipalName]: {\r\n                        displayName: \"User Principal Name\",\r\n                        type: \"string\"\r\n                    },\r\n                    [TeamResourceProvisioningOptions]: {\r\n                        displayName: \"Resource Provisioning Options\",\r\n                        type: \"string\"\r\n                    },\r\n                    [TeamIsArchived]: {\r\n                        displayName: \"Is Archived\",\r\n                        type: \"boolean\"\r\n                    },\r\n                    [TeamIsSuccessful]: {\r\n                        displayName: \"Is Successful\",\r\n                        type: \"boolean\"\r\n                    },\r\n                    [TeamRequestStatusUrl]: {\r\n                        displayName: \"Request Status Url\",\r\n                        type: \"boolean\"\r\n                    },\r\n                    [TeamMsAllowCreateUpdateChannels]: {\r\n                        displayName: \"Allow create/update channels to members\",\r\n                        type: \"boolean\"\r\n                    },\r\n                    [TeamMsAllowDeleteChannels]: {\r\n                        displayName: \"Allow delete channels to members\",\r\n                        type: \"boolean\"\r\n                    },\r\n                    [TeamMsAllowAddRemoveApps]: {\r\n                        displayName: \"Allow add/remove apps to members\",\r\n                        type: \"boolean\"\r\n                    },\r\n                    [TeamMsAllowCreateUpdateRemoveTabs]: {\r\n                        displayName: \"Allow create/update/remove tabs to members\",\r\n                        type: \"boolean\"\r\n                    },\r\n                    [TeamMsAllowCreateUpdateRemoveConnectors]: {\r\n                        displayName: \"Allow create/update/remove connectors to members\",\r\n                        type: \"boolean\"\r\n                    },\r\n                    [TeamGsAllowCreateUpdateChannels]: {\r\n                        displayName: \"Allow create/update channels to guests\",\r\n                        type: \"boolean\"\r\n                    },\r\n                    [TeamGsAllowDeleteChannels]: {\r\n                        displayName: \"Allow delete channels to guests\",\r\n                        type: \"boolean\"\r\n                    },\r\n                    [TeamMsgAllowUserEditMessages]: {\r\n                        displayName: \"Allow user to edit messages\",\r\n                        type: \"boolean\"\r\n                    },\r\n                    [TeamMsgAllowUserDeleteMessages]: {\r\n                        displayName: \"Allow user to delete messages\",\r\n                        type: \"boolean\"\r\n                    },\r\n                    [TeamMsgAllowOwnerDeleteMessages]: {\r\n                        displayName: \"Allow owner to delete messages\",\r\n                        type: \"boolean\"\r\n                    },\r\n                    [TeamMsgAllowTeamMentions]: {\r\n                        displayName: \"Allow team mentions\",\r\n                        type: \"boolean\"\r\n                    },\r\n                    [TeamMsgAllowChannelMentions]: {\r\n                        displayName: \"Allow channel mentions\",\r\n                        type: \"boolean\"\r\n                    },\r\n                    [TeamFsAllowGiphy]: {\r\n                        displayName: \"Allow Giphy\",\r\n                        type: \"boolean\"\r\n                    },\r\n                    [TeamFsAllowStickersAndMemes]: {\r\n                        displayName: \"Allow stickers and memes\",\r\n                        type: \"boolean\"\r\n                    },\r\n                    [TeamFsAllowCustomMemes]: {\r\n                        displayName: \"Allow custom memes\",\r\n                        type: \"boolean\"\r\n                    }\r\n                },\r\n                methods: {\r\n                    [TeamGet]: {\r\n                        displayName: \"Get\",\r\n                        description: \"Retrieves the details of a Team\",\r\n                        type: \"read\",\r\n                        inputs: [TeamId],\r\n                        requiredInputs: [TeamId],\r\n                        outputs: [\r\n                            TeamId,\r\n                            TeamDisplayName,\r\n                            TeamCreationDate,\r\n                            TeamDescription,\r\n                            TeamEmail,\r\n                            TeamMailEnabled,\r\n                            TeamMailNickname,\r\n                            TeamWeburl,\r\n                            TeamArchiveStatus,\r\n                            TeamIsSuccessful\r\n                        ]\r\n                    },\r\n                    [TeamCreate]: {\r\n                        displayName: \"Create\",\r\n                        description: \"Creates a Team\",\r\n                        type: \"create\",\r\n                        inputs: [\r\n                            TeamDisplayName,\r\n                            TeamDescription,\r\n                            TeamMailEnabled,\r\n                            TeamMailNickname,\r\n                            TeamUserPrincipalName\r\n                        ],\r\n                        requiredInputs: [TeamDisplayName,\r\n                            TeamMailEnabled,\r\n                            TeamMailNickname\r\n                        ],\r\n                        outputs: [\r\n                            TeamId,\r\n                            TeamDisplayName,\r\n                            TeamCreationDate,\r\n                            TeamDescription,\r\n                            TeamEmail,\r\n                            TeamMailEnabled,\r\n                            TeamMailNickname,\r\n                            TeamWeburl,\r\n                            TeamIsSuccessful\r\n                        ]\r\n                    },\r\n                    // [TeamAdd]: {\r\n                    //     displayName: \"Add\",\r\n                    //     description: \"Adds a Team to an existing group\",\r\n                    //     type: \"create\",\r\n                    //     inputs: [TeamId,\r\n                    //         TeamUserPrincipalName\r\n                    //     ],\r\n                    //     outputs: [TeamId,\r\n                    //         TeamDisplayName,\r\n                    //         TeamCreationDate,\r\n                    //         TeamDescription,\r\n                    //         TeamEmail,\r\n                    //         TeamMailEnabled,\r\n                    //         TeamMailNickname,\r\n                    //         TeamWeburl,\r\n                    //         TeamIsSuccessful\r\n                    //     ]\r\n                    // },\r\n                    [TeamArchive]: {\r\n                        displayName: \"Archive\",\r\n                        description: \"Archives a Team (makes it read-only)\",\r\n                        type: \"execute\",\r\n                        inputs: [TeamId],\r\n                        requiredInputs: [TeamId],\r\n                        outputs: [TeamId,\r\n                            TeamRequestStatusUrl,\r\n                            TeamIsSuccessful\r\n                        ]\r\n                    },\r\n                    [TeamUnarchive]: {\r\n                        displayName: \"Unarchive\",\r\n                        description: \"Unarchives a Team\",\r\n                        type: \"execute\",\r\n                        inputs: [TeamId],\r\n                        requiredInputs: [TeamId],\r\n                        outputs: [TeamId,\r\n                            TeamRequestStatusUrl,\r\n                            TeamIsSuccessful\r\n                        ]\r\n                    },\r\n                    /*                     [TeamCheckStatus]: {\r\n                                            displayName: \"Check Status\",\r\n                                            description: \"Check the status of an Archive job.\",\r\n                                            type: \"execute\",\r\n                                            parameters: {\r\n                                                [TeamArchiveOperationUrl]: {\r\n                                                    displayName: \"Archive/Unarchive operation URL\",\r\n                                                    type: \"string\"\r\n                                                }\r\n                                            },\r\n                                            requiredParameters: [TeamArchiveOperationUrl],\r\n                                            outputs: [TeamOperationId,\r\n                                                TeamOperationType,\r\n                                                TeamCreationDate,\r\n                                                TeamArchiveStatus,\r\n                                                TeamLastActionDate,\r\n                                                TeamAttemptsCount,\r\n                                                TeamTargetResourceId,\r\n                                                TeamTargetResourceLocation,\r\n                                                TeamArchiveError\r\n                                            ]\r\n                                        }, */\r\n                    [TeamAddMember]: {\r\n                        displayName: \"Add Member\",\r\n                        description: \"Adds a member to a Team\",\r\n                        type: \"create\",\r\n                        inputs: [TeamId,\r\n                            TeamUserPrincipalName\r\n                        ],\r\n                        requiredInputs: [TeamId,\r\n                            TeamUserPrincipalName\r\n                        ],\r\n                        outputs: [TeamIsSuccessful\r\n                        ]\r\n                    },\r\n                    [TeamRemoveMember]: { // TODO\r\n                        displayName: \"Remove Member\",\r\n                        description: \"Removes a member from a Team\",\r\n                        type: \"delete\",\r\n                        inputs: [\r\n                            TeamId,\r\n                            TeamUserPrincipalName // TODO maybe id ?\r\n                        ],\r\n                        requiredInputs: [\r\n                            TeamId,\r\n                            TeamUserPrincipalName // TODO maybe id ?\r\n                        ],\r\n                        outputs: [\r\n                            TeamIsSuccessful\r\n                        ]\r\n                    },\r\n                    [TeamUpdate]: {\r\n                        displayName: \"Update\",\r\n                        description: \"Updates a Team's settings\",\r\n                        type: \"update\",\r\n                        inputs: [TeamId,\r\n                            TeamMsAllowCreateUpdateChannels,\r\n                            TeamMsAllowDeleteChannels,\r\n                            TeamMsAllowAddRemoveApps,\r\n                            TeamMsAllowCreateUpdateRemoveTabs,\r\n                            TeamMsAllowCreateUpdateRemoveConnectors,\r\n                            TeamGsAllowCreateUpdateChannels,\r\n                            TeamGsAllowDeleteChannels,\r\n                            TeamMsgAllowUserEditMessages,\r\n                            TeamMsgAllowUserDeleteMessages,\r\n                            TeamMsgAllowUserDeleteMessages,\r\n                            TeamMsgAllowTeamMentions,\r\n                            TeamMsgAllowChannelMentions,\r\n                            TeamFsAllowGiphy,\r\n                            TeamFsAllowStickersAndMemes,\r\n                            TeamFsAllowCustomMemes\r\n                        ],\r\n                        requiredInputs: [TeamId],\r\n                        outputs: [TeamIsSuccessful\r\n                        ]\r\n                    },\r\n                    [TeamClone]: {\r\n                        displayName: \"Copy/Clone\",\r\n                        description: \"Makes a copy of an existing Team\",\r\n                        type: \"create\",\r\n                        inputs: [TeamId,\r\n                            TeamDisplayName,\r\n                            TeamDescription,\r\n                            TeamMailNickname\r\n                        ],\r\n                        requiredInputs: [TeamId,\r\n                            TeamDisplayName,\r\n                            TeamDescription,\r\n                            TeamMailNickname\r\n                        ],\r\n                        outputs: [TeamId,\r\n                            TeamRequestStatusUrl,\r\n                            TeamIsSuccessful\r\n                        ]\r\n                    },\r\n                    [TeamAddOwner]: {\r\n                        displayName: \"Add Owner\",\r\n                        description: \"Adds an Owner to a Team\",\r\n                        type: \"execute\",\r\n                        // parameters: {\r\n                        //     [TeamAddAsMemberAlso]: {\r\n                        //         displayName: \"Add as Member Also\",\r\n                        //         type: \"boolean\"\r\n                        //     }\r\n                        // },\r\n                        inputs: [TeamId,\r\n                            TeamUserPrincipalName\r\n                        ],\r\n                        requiredInputs: [TeamId,\r\n                            TeamUserPrincipalName\r\n                        ],\r\n                        outputs: [\r\n                            TeamIsSuccessful\r\n                        ]\r\n                    },\r\n                    [TeamList]: {\r\n                        displayName: \"List\",\r\n                        description: \"Lists all Teams and groups without Teams\",\r\n                        type: \"list\",\r\n                        parameters: {\r\n                            [TeamDisplayNameStartsWith]: {\r\n                                displayName: \"Display Name Starts With\",\r\n                                type: \"string\"\r\n                            }\r\n                        },\r\n                        outputs: [TeamId,\r\n                            TeamDisplayName,\r\n                            TeamResourceProvisioningOptions\r\n                        ]\r\n                    },\r\n                    [TeamMyTeamsList]: {\r\n                        displayName: \"List My Teams\",\r\n                        description: \"Lists all Teams you belong to\",\r\n                        type: \"list\",\r\n                        outputs: [TeamId,\r\n                            TeamDisplayName,\r\n                            TeamDescription,\r\n                            TeamIsArchived\r\n                        ]\r\n                    }\r\n                }\r\n            },\r\n            [Channel]: {\r\n                displayName: \"Channel\",\r\n                description: \"Channel\",\r\n                properties: {\r\n                    [ChannelId]: {\r\n                        displayName: \"Channel Id\",\r\n                        description: \"Channel Id\",\r\n                        type: \"string\"\r\n                    },\r\n                    [ChannelDisplayName]: {\r\n                        displayName: \"Display Name\",\r\n                        description: \"Display Name\",\r\n                        type: \"string\"\r\n                    },\r\n                    [ChannelDescription]: {\r\n                        displayName: \"Description\",\r\n                        description: \"Description\",\r\n                        type: \"string\"\r\n                    },\r\n                    [ChannelEmail]: {\r\n                        displayName: \"Email\",\r\n                        description: \"Email\",\r\n                        type: \"string\"\r\n                    },\r\n                    [ChannelWeburl]: {\r\n                        displayName: \"Web URL\",\r\n                        description: \"Web URL\",\r\n                        type: \"string\"\r\n                    },\r\n                    [ChannelIsSuccessful]: {\r\n                        displayName: \"Is Successful\",\r\n                        description: \"Is Successful\",\r\n                        type: \"string\"\r\n                    },\r\n                    [ChannelTeamId]: {\r\n                        displayName: \"Team Id\",\r\n                        description: \"Team Id\",\r\n                        type: \"string\"\r\n                    },\r\n                    [ChannelMessageSubject]: {\r\n                        displayName: \"Subject\",\r\n                        description: \"Message Subject\",\r\n                        type: \"string\"\r\n                    },\r\n                    [ChannelMessageId]: {\r\n                        displayName: \"Message Id\",\r\n                        description: \"Message Id\",\r\n                        type: \"string\"\r\n                    },\r\n                    [ChannelMessageBody]: {\r\n                        displayName: \"Body\",\r\n                        description: \"Message Body\",\r\n                        type: \"string\"\r\n                    },\r\n                    [ChannelMessageIsImportant]: {\r\n                        displayName: \"Is Important\",\r\n                        description: \"Message Importance (Normal/High)\",\r\n                        type: \"boolean\"\r\n                    },\r\n                    [MembershipType]: {\r\n                        displayName: \"Membership Type\",\r\n                        description: \"Type of Channel\",\r\n                        type: \"string\"\r\n                    },\r\n                    [ChannelUserPrincipalName]: {\r\n                        displayName: \"User Principal Name\",\r\n                        description: \"Principal Name of User\",\r\n                        type: \"string\"\r\n                    },\r\n                    [ChannelMessageDate]: {\r\n                        displayName: \"Message Date\",\r\n                        description: \"Message Date\",\r\n                        type: \"dateTime\"\r\n                    },\r\n                    [ChannelMessageUser]: {\r\n                        displayName: \"Message User\",\r\n                        description: \"Message User\",\r\n                        type: \"string\"\r\n                    },\r\n                    [ChannelDriveId]: {\r\n                        displayName: \"Drive ID\",\r\n                        description: \"Drive ID\",\r\n                        type: \"string\"\r\n                    },\r\n                    [ChannelDriveUrl]: {\r\n                        displayName: \"Drive URL\",\r\n                        description: \"Drive URL\",\r\n                        type: \"string\"\r\n                    },\r\n                    [ChannelUserName]: {\r\n                        displayName: \"Name\",\r\n                        description: \"Name\",\r\n                        type: \"string\"\r\n                    },\r\n                    [ChannelUserId]: {\r\n                        displayName: \"User ID\",\r\n                        description: \"User ID\",\r\n                        type: \"string\"\r\n                    },\r\n                    [ChannelUserMembershipId]: {\r\n                        displayName: \"Membership ID\",\r\n                        description: \"Membership ID\",\r\n                        type: \"string\"\r\n                    }\r\n                },\r\n                methods: {\r\n                    [ChannelGet]: {\r\n                        displayName: \"Get\",\r\n                        description: \"Retrieves the details of a Channel\",\r\n                        type: \"read\",\r\n                        inputs: [ChannelTeamId,\r\n                            ChannelId\r\n                        ],\r\n                        requiredInputs: [ChannelId,\r\n                            ChannelTeamId],\r\n                        outputs: [ChannelId,\r\n                            ChannelDisplayName,\r\n                            ChannelDescription,\r\n                            ChannelEmail,\r\n                            ChannelWeburl,\r\n                            ChannelIsSuccessful\r\n                        ]\r\n                    },\r\n                    [ChannelList]: {\r\n                        displayName: \"List\",\r\n                        description: \"List the channels in a Team\",\r\n                        type: \"list\",\r\n                        inputs: [ChannelTeamId],\r\n                        requiredInputs: [ChannelTeamId],\r\n                        outputs: [ChannelId,\r\n                            ChannelDisplayName,\r\n                            ChannelDescription,\r\n                            ChannelEmail\r\n                        ]\r\n                    },\r\n                    [ChannelCreate]: {\r\n                        displayName: \"Create\",\r\n                        description: \"Creates a new Channel\",\r\n                        type: \"create\",\r\n                        inputs: [ChannelTeamId,\r\n                            ChannelDisplayName,\r\n                            MembershipType,\r\n                            ChannelDescription\r\n                        ],\r\n                        requiredInputs: [ChannelTeamId,\r\n                            ChannelDisplayName,\r\n                            MembershipType\r\n                        ],\r\n                        outputs: [ChannelId,\r\n                            ChannelDisplayName,\r\n                            ChannelDescription,\r\n                            ChannelEmail,\r\n                            ChannelWeburl,\r\n                            ChannelIsSuccessful\r\n                        ]\r\n                    },\r\n                    [ChannelDelete]: {\r\n                        displayName: \"Delete\",\r\n                        description: \"Deletes a Channel\",\r\n                        type: \"delete\",\r\n                        inputs: [ChannelId,\r\n                            ChannelTeamId\r\n                        ],\r\n                        requiredInputs: [ChannelId,\r\n                            ChannelTeamId],\r\n                        outputs: [ChannelIsSuccessful]\r\n                    },\r\n                    [ChannelUpdate]: {\r\n                        displayName: \"Update\",\r\n                        description: \"Updates a Channel\",\r\n                        type: \"update\",\r\n                        inputs: [ChannelTeamId,\r\n                            ChannelId,\r\n                            ChannelDisplayName,\r\n                            ChannelDescription\r\n                        ],\r\n                        requiredInputs: [ChannelId,\r\n                            ChannelTeamId,\r\n                            ChannelDisplayName,\r\n                            ChannelDescription],\r\n                        outputs: [ChannelIsSuccessful]\r\n                    },\r\n                    [ChannelAddMember]: {\r\n                        displayName: \"Add Member\",\r\n                        description: \"Adds a member to a Channel\",\r\n                        type: \"create\",\r\n                        inputs: [ChannelTeamId,\r\n                            ChannelId,\r\n                            ChannelUserPrincipalName\r\n                        ],\r\n                        requiredInputs: [ChannelTeamId,\r\n                            ChannelId,\r\n                            ChannelUserPrincipalName\r\n                        ],\r\n                        outputs: [ChannelIsSuccessful]\r\n                    },\r\n                    [ChannelSendMessage]: {\r\n                        displayName: \"Send Message\",\r\n                        description: \"Sends a Message to a Channel\",\r\n                        type: \"create\",\r\n                        inputs: [ChannelTeamId,\r\n                            ChannelId,\r\n                            ChannelMessageSubject,\r\n                            ChannelMessageBody,\r\n                            ChannelMessageIsImportant\r\n                        ],\r\n                        requiredInputs: [ChannelTeamId,\r\n                            ChannelId,\r\n                            ChannelMessageBody\r\n                        ],\r\n                        outputs: [ChannelIsSuccessful, ChannelMessageId]\r\n                    },\r\n                    [ChannelReplyMessage]: {\r\n                        displayName: \"Reply to a Message\",\r\n                        description: \"Reply to a Message in a Channel\",\r\n                        type: \"create\",\r\n                        inputs: [ChannelTeamId,\r\n                            ChannelId,\r\n                            ChannelMessageId,\r\n                            ChannelMessageBody\r\n                        ],\r\n                        requiredInputs: [ChannelTeamId,\r\n                            ChannelId,\r\n                            ChannelMessageId,\r\n                            ChannelMessageBody\r\n                        ],\r\n                        outputs: [ChannelIsSuccessful]\r\n                    },\r\n                    [ChannelSendAdaptiveCard]: {\r\n                        displayName: \"Send Adaptive Card\",\r\n                        description: \"Sends a Message to a Channel\",\r\n                        type: \"create\",\r\n                        inputs: [ChannelTeamId,\r\n                            ChannelId,\r\n                            ChannelMessageBody\r\n                        ],\r\n                        requiredInputs: [ChannelTeamId,\r\n                            ChannelId,\r\n                            ChannelMessageBody\r\n                        ],\r\n                        outputs: [ChannelIsSuccessful, ChannelMessageId]\r\n                    },\r\n                    [ChannelMessages]: {\r\n                        displayName: \"Get Messages in a Channel\",\r\n                        description: \"Get Messages in a Channel\",\r\n                        type: \"list\",\r\n                        inputs: [ChannelTeamId,\r\n                            ChannelId\r\n                        ],\r\n                        requiredInputs: [ChannelTeamId,\r\n                            ChannelId\r\n                        ],\r\n                        outputs: [ChannelMessageId, ChannelMessageBody, ChannelMessageDate, ChannelMessageUser]\r\n                    },\r\n                    [ChannelGetDrive]: {\r\n                        displayName: \"Get Channel Drive\",\r\n                        description: \"Get Channel Drive\",\r\n                        type: \"read\",\r\n                        inputs: [ChannelTeamId,\r\n                            ChannelId\r\n                        ],\r\n                        requiredInputs: [ChannelTeamId,\r\n                            ChannelId\r\n                        ],\r\n                        outputs: [ChannelDriveId, ChannelDriveUrl]\r\n                    },\r\n                    [ChannelMembers]: {\r\n                        displayName: \"Get Channel Members\",\r\n                        description: \"Get Channel Members\",\r\n                        type: \"list\",\r\n                        inputs: [ChannelTeamId,\r\n                            ChannelId\r\n                        ],\r\n                        requiredInputs: [ChannelId,\r\n                            ChannelTeamId],\r\n                        outputs: [ChannelUserId, ChannelUserName, ChannelUserPrincipalName, ChannelUserMembershipId]\r\n                    },\r\n                    [ChannelRemoveMember]: {\r\n                        displayName: \"Remove Member\",\r\n                        description: \"Removes a member from a Channel\",\r\n                        type: \"delete\",\r\n                        inputs: [ChannelTeamId,\r\n                            ChannelId,\r\n                            ChannelUserId\r\n                        ],\r\n                        requiredInputs: [ChannelTeamId,\r\n                            ChannelId,\r\n                            ChannelUserId\r\n                        ],\r\n                        outputs: [ChannelIsSuccessful]\r\n                    }\r\n                }\r\n            },\r\n            [Tab]: {\r\n                displayName: \"Tab\",\r\n                description: \"Tab\",\r\n                properties: {\r\n                    [TabId]: {\r\n                        displayName: \"Tab Id\",\r\n                        description: \"Tab Id\",\r\n                        type: \"string\"\r\n                    },\r\n                    [TabDisplayName]: {\r\n                        displayName: \"Display Name\",\r\n                        description: \"Display Name\",\r\n                        type: \"string\"\r\n                    },\r\n                    [TabConfigEntityId]: {\r\n                        displayName: \"Entity Id\",\r\n                        description: \"Entity Id\",\r\n                        type: \"string\"\r\n                    },\r\n                    [TabConfigContentUrl]: {\r\n                        displayName: \"Content URL\",\r\n                        description: \"Content URL\",\r\n                        type: \"string\"\r\n                    },\r\n                    [TabConfigWebsiteUrl]: {\r\n                        displayName: \"Website URL\",\r\n                        description: \"Website URL\",\r\n                        type: \"string\"\r\n                    },\r\n                    [TabConfigRemoveUrl]: {\r\n                        displayName: \"Remove URL\",\r\n                        description: \"Remove URL\",\r\n                        type: \"string\"\r\n                    },\r\n                    [TabTeamsAppAppId]: {\r\n                        displayName: \"App Id\",\r\n                        description: \"App Id\",\r\n                        type: \"string\"\r\n                    },\r\n                    [TabTeamsAppExternalId]: {\r\n                        displayName: \"External Id\",\r\n                        description: \"External Id\",\r\n                        type: \"string\"\r\n                    },\r\n                    [TabTeamsAppAppDisplayName]: {\r\n                        displayName: \"App Display Name\",\r\n                        description: \"App Display Name\",\r\n                        type: \"string\"\r\n                    },\r\n                    [TabTeamsAppDistMethod]: {\r\n                        displayName: \"Distribution Method\",\r\n                        description: \"Distribution Method\",\r\n                        type: \"string\"\r\n                    },\r\n                    [TabSortOrderIndex]: {\r\n                        displayName: \"Sort Order Index\",\r\n                        description: \"Sort Order Index\",\r\n                        type: \"string\"\r\n                    },\r\n                    [TabWeburl]: {\r\n                        displayName: \"Web URL\",\r\n                        description: \"Web URL\",\r\n                        type: \"string\"\r\n                    },\r\n                    [TabIsSuccessful]: {\r\n                        displayName: \"Is Successful\",\r\n                        description: \"Is Successful\",\r\n                        type: \"boolean\"\r\n                    },\r\n                    [TabTeamId]: {\r\n                        displayName: \"Team Id\",\r\n                        description: \"Team Id\",\r\n                        type: \"string\"\r\n                    },\r\n                    [TabChannelId]: {\r\n                        displayName: \"Channel Id\",\r\n                        description: \"Channel Id\",\r\n                        type: \"string\"\r\n                    }\r\n                },\r\n                methods: {\r\n                    [TabGet]: {\r\n                        displayName: \"Get\",\r\n                        description: \"Get the details of a tab.\",\r\n                        type: \"read\",\r\n                        inputs: [TabId,\r\n                            TabTeamId,\r\n                            TabChannelId\r\n                        ],\r\n                        requiredInputs: [TabId,\r\n                            TabTeamId,\r\n                            TabChannelId\r\n                        ],\r\n                        outputs: [TabId,\r\n                            TabDisplayName,\r\n                            TabConfigEntityId,\r\n                            TabConfigContentUrl,\r\n                            TabConfigWebsiteUrl,\r\n                            TabConfigRemoveUrl,\r\n                            TabTeamsAppAppId,\r\n                            TabTeamsAppExternalId,\r\n                            TabTeamsAppAppDisplayName,\r\n                            TabTeamsAppDistMethod,\r\n                            TabSortOrderIndex,\r\n                            TabWeburl\r\n                        ]\r\n                    },\r\n                    [TabList]: {\r\n                        displayName: \"List\",\r\n                        description: \"List tabs\",\r\n                        type: \"list\",\r\n                        inputs: [TabTeamId,\r\n                            TabChannelId\r\n                        ],\r\n                        requiredInputs: [TabTeamId,\r\n                            TabChannelId\r\n                        ],\r\n                        outputs: [TabId,\r\n                            TabDisplayName,\r\n                            TabWeburl\r\n                        ]\r\n                    },\r\n                    [TabCreateWordTab]: {\r\n                        displayName: \"Create Word tab\",\r\n                        type: \"create\",\r\n                        inputs: [TabTeamId,\r\n                            TabChannelId,\r\n                            TabDisplayName,\r\n                            TabConfigEntityId,\r\n                            TabConfigContentUrl,\r\n                            TabConfigWebsiteUrl,\r\n                            TabConfigRemoveUrl\r\n                        ],\r\n                        requiredInputs: [TabTeamId,\r\n                            TabChannelId,\r\n                            TabDisplayName\r\n                        ],\r\n                        outputs: [TabId,\r\n                            TabDisplayName,\r\n                            TabWeburl,\r\n                            TabConfigEntityId,\r\n                            TabConfigContentUrl,\r\n                            TabConfigWebsiteUrl,\r\n                            TabConfigRemoveUrl,\r\n                            TabIsSuccessful\r\n                        ]\r\n                    },\r\n                    [TabCreateExcelTab]: {\r\n                        displayName: \"Create Excel tab\",\r\n                        type: \"create\",\r\n                        inputs: [TabTeamId,\r\n                            TabChannelId,\r\n                            TabDisplayName,\r\n                            TabConfigEntityId,\r\n                            TabConfigContentUrl,\r\n                            TabConfigWebsiteUrl,\r\n                            TabConfigRemoveUrl\r\n                        ],\r\n                        requiredInputs: [TabTeamId,\r\n                            TabChannelId,\r\n                            TabDisplayName\r\n                        ],\r\n                        outputs: [TabId,\r\n                            TabDisplayName,\r\n                            TabWeburl,\r\n                            TabConfigEntityId,\r\n                            TabConfigContentUrl,\r\n                            TabConfigWebsiteUrl,\r\n                            TabConfigRemoveUrl,\r\n                            TabIsSuccessful\r\n                        ]\r\n                    },\r\n                    [TabCreatePowerPointTab]: {\r\n                        displayName: \"Create PowerPoint tab\",\r\n                        type: \"create\",\r\n                        inputs: [TabTeamId,\r\n                            TabChannelId,\r\n                            TabDisplayName,\r\n                            TabConfigEntityId,\r\n                            TabConfigContentUrl,\r\n                            TabConfigWebsiteUrl,\r\n                            TabConfigRemoveUrl\r\n                        ],\r\n                        requiredInputs: [TabTeamId,\r\n                            TabChannelId,\r\n                            TabDisplayName\r\n                        ],\r\n                        outputs: [TabId,\r\n                            TabDisplayName,\r\n                            TabWeburl,\r\n                            TabConfigEntityId,\r\n                            TabConfigContentUrl,\r\n                            TabConfigWebsiteUrl,\r\n                            TabConfigRemoveUrl,\r\n                            TabIsSuccessful\r\n                        ]\r\n                    },\r\n                    [TabCreatePdfTab]: {\r\n                        displayName: \"Create PDF tab\",\r\n                        type: \"create\",\r\n                        inputs: [TabTeamId,\r\n                            TabChannelId,\r\n                            TabDisplayName,\r\n                            TabConfigEntityId,\r\n                            TabConfigContentUrl,\r\n                            TabConfigWebsiteUrl,\r\n                            TabConfigRemoveUrl\r\n                        ],\r\n                        requiredInputs: [TabTeamId,\r\n                            TabChannelId,\r\n                            TabDisplayName\r\n                        ],\r\n                        outputs: [TabId,\r\n                            TabDisplayName,\r\n                            TabWeburl,\r\n                            TabConfigEntityId,\r\n                            TabConfigContentUrl,\r\n                            TabConfigWebsiteUrl,\r\n                            TabConfigRemoveUrl,\r\n                            TabIsSuccessful\r\n                        ]\r\n                    },\r\n                    [TabCreateOneNoteTab]: {\r\n                        displayName: \"Create OneNote tab\",\r\n                        type: \"create\",\r\n                        inputs: [TabTeamId,\r\n                            TabChannelId,\r\n                            TabDisplayName,\r\n                            TabConfigEntityId,\r\n                            TabConfigContentUrl,\r\n                            TabConfigWebsiteUrl,\r\n                            TabConfigRemoveUrl\r\n                        ],\r\n                        requiredInputs: [TabTeamId,\r\n                            TabChannelId,\r\n                            TabDisplayName\r\n                        ],\r\n                        outputs: [TabId,\r\n                            TabDisplayName,\r\n                            TabWeburl,\r\n                            TabConfigEntityId,\r\n                            TabConfigContentUrl,\r\n                            TabConfigWebsiteUrl,\r\n                            TabConfigRemoveUrl,\r\n                            TabIsSuccessful\r\n                        ]\r\n                    },\r\n                    [TabCreatePlannerTab]: {\r\n                        displayName: \"Create Planner tab\",\r\n                        type: \"create\",\r\n                        inputs: [TabTeamId,\r\n                            TabChannelId,\r\n                            TabDisplayName,\r\n                            TabConfigEntityId,\r\n                            TabConfigContentUrl,\r\n                            TabConfigWebsiteUrl,\r\n                            TabConfigRemoveUrl\r\n                        ],\r\n                        requiredInputs: [TabTeamId,\r\n                            TabChannelId,\r\n                            TabDisplayName\r\n                        ],\r\n                        outputs: [TabId,\r\n                            TabDisplayName,\r\n                            TabWeburl,\r\n                            TabConfigEntityId,\r\n                            TabConfigContentUrl,\r\n                            TabConfigWebsiteUrl,\r\n                            TabConfigRemoveUrl,\r\n                            TabIsSuccessful\r\n                        ]\r\n                    },\r\n                    [TabCreateSharePointTab]: {\r\n                        displayName: \"Create SharePoint tab\",\r\n                        type: \"create\",\r\n                        inputs: [TabTeamId,\r\n                            TabChannelId,\r\n                            TabDisplayName,\r\n                            TabConfigEntityId,\r\n                            TabConfigContentUrl,\r\n                            TabConfigWebsiteUrl,\r\n                            TabConfigRemoveUrl\r\n                        ],\r\n                        requiredInputs: [TabTeamId,\r\n                            TabChannelId,\r\n                            TabDisplayName\r\n                        ],\r\n                        outputs: [TabId,\r\n                            TabDisplayName,\r\n                            TabWeburl,\r\n                            TabConfigEntityId,\r\n                            TabConfigContentUrl,\r\n                            TabConfigWebsiteUrl,\r\n                            TabConfigRemoveUrl,\r\n                            TabIsSuccessful\r\n                        ]\r\n                    },\r\n                    [TabCreateMsFormsTab]: {\r\n                        displayName: \"Create Forms tab\",\r\n                        type: \"create\",\r\n                        inputs: [TabTeamId,\r\n                            TabChannelId,\r\n                            TabDisplayName,\r\n                            TabConfigEntityId,\r\n                            TabConfigContentUrl,\r\n                            TabConfigWebsiteUrl,\r\n                            TabConfigRemoveUrl\r\n                        ],\r\n                        requiredInputs: [TabTeamId,\r\n                            TabChannelId,\r\n                            TabDisplayName\r\n                        ],\r\n                        outputs: [TabId,\r\n                            TabDisplayName,\r\n                            TabWeburl,\r\n                            TabConfigEntityId,\r\n                            TabConfigContentUrl,\r\n                            TabConfigWebsiteUrl,\r\n                            TabConfigRemoveUrl,\r\n                            TabIsSuccessful\r\n                        ]\r\n                    },\r\n                    [TabCreateMsStreamTab]: {\r\n                        displayName: \"Create Stream tab\",\r\n                        type: \"create\",\r\n                        inputs: [TabTeamId,\r\n                            TabChannelId,\r\n                            TabDisplayName,\r\n                            TabConfigEntityId,\r\n                            TabConfigContentUrl,\r\n                            TabConfigWebsiteUrl,\r\n                            TabConfigRemoveUrl\r\n                        ],\r\n                        requiredInputs: [TabTeamId,\r\n                            TabChannelId,\r\n                            TabDisplayName\r\n                        ],\r\n                        outputs: [TabId,\r\n                            TabDisplayName,\r\n                            TabWeburl,\r\n                            TabConfigEntityId,\r\n                            TabConfigContentUrl,\r\n                            TabConfigWebsiteUrl,\r\n                            TabConfigRemoveUrl,\r\n                            TabIsSuccessful\r\n                        ]\r\n                    },\r\n                    [TabCreateWebsiteTab]: {\r\n                        displayName: \"Create Website tab\",\r\n                        type: \"create\",\r\n                        inputs: [TabTeamId,\r\n                            TabChannelId,\r\n                            TabDisplayName,\r\n                            TabConfigEntityId,\r\n                            TabConfigContentUrl,\r\n                            TabConfigWebsiteUrl,\r\n                            TabConfigRemoveUrl\r\n                        ],\r\n                        requiredInputs: [TabTeamId,\r\n                            TabChannelId,\r\n                            TabDisplayName\r\n                        ],\r\n                        outputs: [TabId,\r\n                            TabDisplayName,\r\n                            TabWeburl,\r\n                            TabConfigEntityId,\r\n                            TabConfigContentUrl,\r\n                            TabConfigWebsiteUrl,\r\n                            TabConfigRemoveUrl,\r\n                            TabIsSuccessful\r\n                        ]\r\n                    },\r\n                    [TabCreateWikiTab]: {\r\n                        displayName: \"Create Wiki tab\",\r\n                        type: \"create\",\r\n                        inputs: [TabTeamId,\r\n                            TabChannelId,\r\n                            TabDisplayName,\r\n                            TabConfigEntityId,\r\n                            TabConfigContentUrl,\r\n                            TabConfigWebsiteUrl,\r\n                            TabConfigRemoveUrl\r\n                        ],\r\n                        requiredInputs: [TabTeamId,\r\n                            TabChannelId,\r\n                            TabDisplayName\r\n                        ],\r\n                        outputs: [TabId,\r\n                            TabDisplayName,\r\n                            TabWeburl,\r\n                            TabConfigEntityId,\r\n                            TabConfigContentUrl,\r\n                            TabConfigWebsiteUrl,\r\n                            TabConfigRemoveUrl,\r\n                            TabIsSuccessful\r\n                        ]\r\n                    },\r\n                    [TabCreatePowerBiTab]: {\r\n                        displayName: \"Create PowerBI tab\",\r\n                        type: \"create\",\r\n                        inputs: [TabTeamId,\r\n                            TabChannelId,\r\n                            TabDisplayName,\r\n                            TabConfigEntityId,\r\n                            TabConfigContentUrl,\r\n                            TabConfigWebsiteUrl,\r\n                            TabConfigRemoveUrl\r\n                        ],\r\n                        requiredInputs: [TabTeamId,\r\n                            TabChannelId,\r\n                            TabDisplayName\r\n                        ],\r\n                        outputs: [TabId,\r\n                            TabDisplayName,\r\n                            TabWeburl,\r\n                            TabConfigEntityId,\r\n                            TabConfigContentUrl,\r\n                            TabConfigWebsiteUrl,\r\n                            TabConfigRemoveUrl,\r\n                            TabIsSuccessful\r\n                        ]\r\n                    },\r\n                    [TabCreateDocumentLibraryTab]: {\r\n                        displayName: \"Create Document tab\",\r\n                        type: \"create\",\r\n                        inputs: [TabTeamId,\r\n                            TabChannelId,\r\n                            TabDisplayName,\r\n                            TabConfigEntityId,\r\n                            TabConfigContentUrl,\r\n                            TabConfigWebsiteUrl,\r\n                            TabConfigRemoveUrl\r\n                        ],\r\n                        requiredInputs: [TabTeamId,\r\n                            TabChannelId,\r\n                            TabDisplayName\r\n                        ],\r\n                        outputs: [TabId,\r\n                            TabDisplayName,\r\n                            TabWeburl,\r\n                            TabConfigEntityId,\r\n                            TabConfigContentUrl,\r\n                            TabConfigWebsiteUrl,\r\n                            TabConfigRemoveUrl,\r\n                            TabIsSuccessful\r\n                        ]\r\n                    },\r\n                    [TabCreateCustomTab]: {\r\n                        displayName: \"Create custom tab\",\r\n                        type: \"create\",\r\n                        inputs: [TabTeamId,\r\n                            TabChannelId,\r\n                            TabTeamsAppAppId,\r\n                            TabDisplayName,\r\n                            TabConfigEntityId,\r\n                            TabConfigContentUrl,\r\n                            TabConfigWebsiteUrl,\r\n                            TabConfigRemoveUrl\r\n                        ],\r\n                        requiredInputs: [TabTeamId,\r\n                            TabChannelId,\r\n                            TabTeamsAppAppId,\r\n                            TabDisplayName\r\n                        ],\r\n                        outputs: [TabId,\r\n                            TabDisplayName,\r\n                            TabWeburl,\r\n                            TabConfigEntityId,\r\n                            TabConfigContentUrl,\r\n                            TabConfigWebsiteUrl,\r\n                            TabConfigRemoveUrl,\r\n                            TabIsSuccessful\r\n                        ]\r\n                    },\r\n                    [TabDelete]: {\r\n                        displayName: \"Delete tab\",\r\n                        type: \"delete\",\r\n                        inputs: [TabTeamId,\r\n                            TabChannelId,\r\n                            TabId\r\n                        ],\r\n                        requiredInputs: [TabTeamId,\r\n                            TabChannelId,\r\n                            TabId\r\n                        ],\r\n                        outputs: [\r\n                            TabIsSuccessful\r\n                        ]\r\n                    },\r\n                    [TabUpdate]: {\r\n                        displayName: \"Update tab\",\r\n                        type: \"update\",\r\n                        inputs: [TabTeamId,\r\n                            TabChannelId,\r\n                            TabId,\r\n                            TabDisplayName,\r\n                            TabConfigContentUrl,\r\n                            TabConfigWebsiteUrl,\r\n                            TabConfigRemoveUrl\r\n                        ],\r\n                        requiredInputs: [TabTeamId,\r\n                            TabChannelId,\r\n                            TabId\r\n                        ],\r\n                        outputs: [TabIsSuccessful]\r\n                    },\r\n                }\r\n            },\r\n            [App]: {\r\n                displayName: \"App\",\r\n                description: \"App\",\r\n                properties: {\r\n                    [AppId]: {\r\n                        displayName: \"App Id\",\r\n                        description: \"App Id\",\r\n                        type: \"string\"\r\n                    },\r\n                    [AppTeamId]: {\r\n                        displayName: \"Team Id\",\r\n                        description: \"Team Id\",\r\n                        type: \"string\"\r\n                    },\r\n                    [AppDisplayName]: {\r\n                        displayName: \"App Display Name\",\r\n                        description: \"App Display Name\",\r\n                        type: \"string\"\r\n                    },\r\n                    [AppVersion]: {\r\n                        displayName: \"version\",\r\n                        description: \"version\",\r\n                        type: \"string\"\r\n                    },\r\n                    [AppTeamAppDefinitionId]: {\r\n                        displayName: \"Teams App Definition Id\",\r\n                        description: \"Teams App Definition Id\",\r\n                        type: \"string\"\r\n                    },\r\n                    [AppTeamsAppId]: {\r\n                        displayName: \"Teams App Id\",\r\n                        description: \"Teams App Id\",\r\n                        type: \"string\"\r\n                    }\r\n                },\r\n                methods: {\r\n                    [AppList]: {\r\n                        displayName: \"List installed apps\",\r\n                        type: \"list\",\r\n                        inputs: [AppTeamId],\r\n                        requiredInputs: [AppTeamId],\r\n                        outputs: [AppId,\r\n                            AppDisplayName,\r\n                            AppVersion,\r\n                            AppTeamAppDefinitionId,\r\n                            AppTeamsAppId\r\n                        ]\r\n                    }\r\n                }\r\n            },\r\n            [Token]: {\r\n                displayName: \"Token\",\r\n                description: \"Token\",\r\n                properties: {\r\n                    [TokenLifetime]: {\r\n                        displayName: \"Token Lifetime (hh:mm:ss)\",\r\n                        description: \"Token Lifetime (hh:mm:ss)\",\r\n                        type: \"string\"\r\n                    },\r\n                    [TokenPolicyDisplayName]: {\r\n                        displayName: \"Policy Display Name\",\r\n                        description: \"Policy Display Name\",\r\n                        type: \"string\"\r\n                    },\r\n                    [TokenOrganizationDefault]: {\r\n                        displayName: \"Is Organization Default\",\r\n                        description: \"Is Organization Default\",\r\n                        type: \"boolean\"\r\n                    },\r\n                    [TokenUpdateSuccess]: {\r\n                        displayName: \"Policy Update Success\",\r\n                        description: \"Policy Update Success\",\r\n                        type: \"boolean\"\r\n                    }\r\n                },\r\n                methods: {\r\n                    [TokenPolicySet]: {\r\n                        displayName: \"Set Token Policy\",\r\n                        type: \"execute\",\r\n                        inputs: [TokenLifetime, TokenPolicyDisplayName, TokenOrganizationDefault],\r\n                        requiredInputs: [TokenLifetime, TokenPolicyDisplayName],\r\n                        outputs: [TokenUpdateSuccess]\r\n                    }\r\n                }\r\n            },\r\n            [Drive]: {\r\n                displayName: \"Drive\",\r\n                description: \"Drive\",\r\n                properties: {\r\n                    [DriveId]: {\r\n                        displayName: \"Drive ID\",\r\n                        description: \"Drive ID\",\r\n                        type: \"string\"\r\n                    },\r\n                    [DriveRelativePath]: {\r\n                        displayName: \"Relative Path\",\r\n                        description: \"Relative Path\",\r\n                        type: \"string\"\r\n                    },\r\n                    [DriveChildDownloadUrl]: {\r\n                        displayName: \"Download URL\",\r\n                        description: \"Download URL\",\r\n                        type: \"string\"\r\n                    },\r\n                    [DriveChildFileCreated]: {\r\n                        displayName: \"Created Date\",\r\n                        description: \"Created Date\",\r\n                        type: \"dateTime\"\r\n                    },\r\n                    [DriveChildFileCreatedBy]: {\r\n                        displayName: \"Created By\",\r\n                        description: \"Created By\",\r\n                        type: \"string\"\r\n                    },\r\n                    [DriveChildFileName]: {\r\n                        displayName: \"File Name\",\r\n                        description: \"File Name\",\r\n                        type: \"string\"\r\n                    },\r\n                    [DriveChildFileType]: {\r\n                        displayName: \"File Type\",\r\n                        description: \"File Type\",\r\n                        type: \"string\"\r\n                    },\r\n                    [DriveChildId]: {\r\n                        displayName: \"File ID\",\r\n                        description: \"File ID\",\r\n                        type: \"string\"\r\n                    },\r\n                    [DriveChildWebUrl]: {\r\n                        displayName: \"Web URL\",\r\n                        description: \"Web URL\",\r\n                        type: \"string\"\r\n                    },\r\n                    [DriveChildFolderName]: {\r\n                        displayName: \"Folder Name\",\r\n                        description: \"Folder Name\",\r\n                        type: \"string\"\r\n                    }\r\n                },\r\n                methods: {\r\n                    [DriveGetRootChildren]: {\r\n                        displayName: \"Get Drive Root Children\",\r\n                        type: \"list\",\r\n                        inputs: [DriveId],\r\n                        requiredInputs: [DriveId],\r\n                        outputs: [DriveChildId, DriveChildFolderName, DriveChildWebUrl]\r\n                    }\r\n                }\r\n            },\r\n            [Site]: {\r\n                displayName: \"Site\",\r\n                description: \"Site\",\r\n                properties: {\r\n                    [SiteListId]: {\r\n                        displayName: \"List ID\",\r\n                        description: \"List ID\",\r\n                        type: \"string\"\r\n                    },\r\n                    [SiteRelativePath]: {\r\n                        displayName: \"Relative Path\",\r\n                        description: \"Relative Path\",\r\n                        type: \"string\"\r\n                    },\r\n                    [SiteListName]: {\r\n                        displayName: \"List Name\",\r\n                        description: \"List Name\",\r\n                        type: \"string\"\r\n                    },\r\n                    [SiteListDisplayName]: {\r\n                        displayName: \"List Display Name\",\r\n                        description: \"List Display Name\",\r\n                        type: \"string\"\r\n                    }\r\n                },\r\n                methods: {\r\n                    [SiteGetLists]: {\r\n                        displayName: \"Get Site Lists\",\r\n                        type: \"list\",\r\n                        inputs: [SiteRelativePath],\r\n                        requiredInputs: [SiteRelativePath],\r\n                        outputs: [SiteListId, SiteListName, SiteListDisplayName]\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n    });\r\n}\r\n\r\n// OnExecute\r\nonexecute = function ({ objectName, methodName, parameters, properties }) {\r\n    switch (objectName) {\r\n        case Team:\r\n            onexecuteTeam(methodName, parameters, properties);\r\n            break;\r\n        case Channel:\r\n            onexecuteChannel(methodName, parameters, properties);\r\n            break;\r\n        case Tab:\r\n            onexecuteTab(methodName, parameters, properties);\r\n            break;\r\n        case App:\r\n            onexecuteApp(methodName, parameters, properties);\r\n            break;\r\n        case Token:\r\n            onexecuteToken(methodName, parameters, properties);\r\n            break;\r\n        case Drive:\r\n            onexecuteDrive(methodName, parameters, properties);\r\n            break;\r\n        case Site:\r\n            onexecuteSite(methodName, parameters, properties);\r\n            break;\r\n        default: throw new Error(\"The object \" + objectName + \" is not supported.\");\r\n    }\r\n}\r\n\r\nfunction onexecuteApp(methodName: string, parameters: SingleRecord, properties: SingleRecord) {\r\n    switch (methodName) {\r\n        case AppList:\r\n            onexecuteInstalledAppList(parameters, properties);\r\n            break;\r\n        default: throw new Error(\"The method \" + methodName + \" is not supported..\");\r\n    }\r\n}\r\n\r\nfunction onexecuteToken(methodName: string, parameters: SingleRecord, properties: SingleRecord) {\r\n    switch (methodName) {\r\n        case TokenPolicySet:\r\n            onexecutePolicySet(parameters, properties);\r\n            break;\r\n        default: throw new Error(\"The method \" + methodName + \" is not supported..\");\r\n    }\r\n}\r\n\r\nfunction onexecuteDrive(methodName: string, parameters: SingleRecord, properties: SingleRecord) {\r\n    switch (methodName) {\r\n        case DriveGetRootChildren:\r\n            onexecuteGetDriveRootChildren(parameters, properties);\r\n            break;\r\n        default: throw new Error(\"The method \" + methodName + \" is not supported..\");\r\n    }\r\n}\r\n\r\nfunction onexecuteSite(methodName: string, parameters: SingleRecord, properties: SingleRecord) {\r\n    switch (methodName) {\r\n        case SiteGetLists:\r\n            onexecuteGetSiteLists(parameters, properties);\r\n            break;\r\n        default: throw new Error(\"The method \" + methodName + \" is not supported..\");\r\n    }\r\n}\r\n\r\nfunction onexecuteTeam(methodName: string, parameters: SingleRecord, properties: SingleRecord) {\r\n    if (properties == null && parameters == null) {\r\n        //do nothing\r\n    }\r\n    else if (properties == null && parameters !== null) {\r\n        parameters[TeamIsSuccessful] = true;\r\n    }\r\n    else {\r\n        properties[TeamIsSuccessful] = true;\r\n    }\r\n    switch (methodName) {\r\n        case TeamGet:\r\n            onexecuteTeamGet(parameters, properties);\r\n            break;\r\n        case TeamCreate:\r\n            onexecuteTeamCreate(parameters, properties);\r\n            break;\r\n        case TeamAdd:\r\n            onexecuteTeamAdd(parameters, properties);\r\n            break;\r\n        case TeamUpdate:\r\n            onexecuteTeamUpdate(parameters, properties);\r\n            break;\r\n        case TeamList:\r\n            onexecuteTeamList(parameters, properties);\r\n            break;\r\n        case TeamArchive:\r\n            onexecuteTeamArchive(parameters, properties);\r\n            break;\r\n        case TeamUnarchive:\r\n            onexecuteTeamUnarchive(parameters, properties);\r\n            break;\r\n        case TeamAddMember:\r\n            onexecuteTeamAddMember(parameters, properties);\r\n            break;\r\n        case TeamRemoveMember:\r\n            onexecuteTeamRemoveMember(parameters, properties);\r\n            break;\r\n        case TeamClone:\r\n            onexecuteTeamClone(parameters, properties);\r\n            break;\r\n        case TeamAddOwner:\r\n            onexecuteTeamAddOwner(parameters, properties);\r\n            break;\r\n        case TeamMyTeamsList:\r\n            onexecuteTeamMyTeamsList(parameters, properties);\r\n            break;\r\n        case TeamCheckStatus:\r\n            onexecuteTeamCheckStatus(parameters, properties);\r\n            break;\r\n        default: throw new Error(\"The method \" + methodName + \" is not supported..\");\r\n    }\r\n}\r\n\r\nfunction onexecuteTab(methodName: string, parameters: SingleRecord, properties: SingleRecord) {\r\n    if (properties == null && parameters == null) {\r\n        //do nothing\r\n    }\r\n    else if (properties == null && parameters !== null) {\r\n        parameters[TabIsSuccessful] = true;\r\n    }\r\n    else {\r\n        properties[TabIsSuccessful] = true;\r\n    }\r\n    switch (methodName) {\r\n        case TabGet:\r\n            onexecuteTabGet(parameters, properties);\r\n            break;\r\n        case TabUpdate:\r\n            onexecuteTabUpdate(parameters, properties);\r\n            break;\r\n        case TabList:\r\n            onexecuteTabList(parameters, properties);\r\n            break;\r\n        case TabDelete:\r\n            onexecuteTabDelete(parameters, properties);\r\n            break;\r\n        case TabCreateWordTab:\r\n            onexecuteTabCreate(methodName, parameters, properties);\r\n            break;\r\n        case TabCreateExcelTab:\r\n            onexecuteTabCreate(methodName, parameters, properties);\r\n            break;\r\n        case TabCreatePowerPointTab:\r\n            onexecuteTabCreate(methodName, parameters, properties);\r\n            break;\r\n        case TabCreatePdfTab:\r\n            onexecuteTabCreate(methodName, parameters, properties);\r\n            break;\r\n        case TabCreateOneNoteTab:\r\n            onexecuteTabCreate(methodName, parameters, properties);\r\n            break;\r\n        case TabCreatePlannerTab:\r\n            onexecuteTabCreate(methodName, parameters, properties);\r\n            break;\r\n        case TabCreateSharePointTab:\r\n            onexecuteTabCreate(methodName, parameters, properties);\r\n            break;\r\n        case TabCreateMsFormsTab:\r\n            onexecuteTabCreate(methodName, parameters, properties);\r\n            break;\r\n        case TabCreateMsStreamTab:\r\n            onexecuteTabCreate(methodName, parameters, properties);\r\n            break;\r\n        case TabCreateWebsiteTab:\r\n            onexecuteTabCreate(methodName, parameters, properties);\r\n            break;\r\n        case TabCreateWikiTab:\r\n            onexecuteTabCreate(methodName, parameters, properties);\r\n            break;\r\n        case TabCreatePowerBiTab:\r\n            onexecuteTabCreate(methodName, parameters, properties);\r\n            break;\r\n        case TabCreateDocumentLibraryTab:\r\n            onexecuteTabCreate(methodName, parameters, properties);\r\n            break;\r\n        case TabCreateCustomTab:\r\n            onexecuteTabCreate(methodName, parameters, properties);\r\n            break;\r\n        default: throw new Error(\"The method \" + methodName + \" is not supported..\");\r\n    }\r\n}\r\n\r\nfunction onexecuteTeamGet(parameters: SingleRecord, properties: SingleRecord) {\r\n    properties[TeamIsSuccessful] = true;\r\n    //properties[TeamId] = properties[TeamId];\r\n    // Get Group Details By Group ID\r\n    GetGroupDetailsById(parameters, properties, function (b) {\r\n        properties[TeamDisplayName] = b.displayName;\r\n        properties[TeamCreationDate] = b.createdDateTime;\r\n        properties[TeamDescription] = b.description;\r\n        properties[TeamEmail] = b.mail;\r\n        properties[TeamMailEnabled] = b.mailEnabled;\r\n        properties[TeamMailNickname] = b.mailNickname;\r\n        //Get Team Details By Group ID\r\n        GetTeamDetailsByID(parameters, properties, function (c) {\r\n            properties[TeamWeburl] = c.webUrl;\r\n            properties[TeamArchiveStatus] = c.isArchived;\r\n            //Post Results\r\n            CreateAndReturnTeamObject(parameters, properties);\r\n        });\r\n    });\r\n}\r\n\r\nfunction onexecuteTeamCreate(parameters: SingleRecord, properties: SingleRecord) {\r\n    // Create a Group, then add a team\r\n    properties[TeamIsSuccessful] = true;\r\n    CreateGroup(parameters, properties, function (a) {\r\n        //properties[TeamId] = parameters[TeamId] = a.id;\r\n        properties[TeamId] = a.id;\r\n        properties[TeamCreationDate] = a.createdDateTime;\r\n        properties[TeamDescription] = a.description;\r\n        properties[TeamDisplayName] = a.displayName;\r\n        properties[TeamEmail] = a.mail;\r\n        properties[TeamMailEnabled] = a.mailEnabled;\r\n        properties[TeamMailNickname] = a.mailNickname;\r\n        //Create a Team under the above Group\r\n        CreateTeam(parameters, properties, function (b) {\r\n            properties[TeamWeburl] = b.webUrl;\r\n            //Get User\r\n            // GetUser(parameters, properties, function (c) {\r\n            //     parameters[TeamUserId] = c.id;\r\n            //     //Add Group Owner\r\n            //     AddGroupOwner(parameters, properties, function (d) {\r\n            //         //Add Members to the Group\r\n            //         AddGroupMembers(parameters, properties, function (d) {\r\n            //             //Post Results\r\n            CreateAndReturnTeamObject(parameters, properties);\r\n            //         });\r\n            //     });\r\n            // });\r\n        });\r\n    });\r\n}\r\n\r\nfunction GetGroupIdByMailNickName(parameters: SingleRecord, properties: SingleRecord, cb) {\r\n    var component = encodeURIComponent(`?$filter=mailNickName&q='${properties[TeamMailNickname]}'`);\r\n    var url = baseUriEndpoint + \"/groups\" + component;\r\n    ExecuteRequest(url, null, \"GET\", function (responseText) {\r\n        if (typeof cb === 'function')\r\n            cb(responseText);\r\n    });\r\n}\r\n\r\nfunction GetGroupDetailsById(parameters: SingleRecord, properties: SingleRecord, cb) {\r\n    let teamId = properties[TeamId];\r\n    if (!(typeof teamId === \"string\")) throw new Error(\"properties[TeamId] is not of type string\");\r\n\r\n    var url = baseUriEndpoint + \"/groups/\" + encodeURIComponent(teamId);\r\n    ExecuteRequest(url, null, \"GET\", function (responseText) {\r\n        if (typeof cb === 'function')\r\n            cb(responseText);\r\n    });\r\n}\r\n\r\nfunction GetTeamDetailsByID(parameters: SingleRecord, properties: SingleRecord, cb) {\r\n    let teamId = properties[TeamId];\r\n    if (!(typeof teamId === \"string\")) throw new Error(\"properties[TeamId] is not of type string\");\r\n\r\n    var url = baseUriEndpoint + \"/teams/\" + encodeURIComponent(teamId);\r\n    ExecuteRequest(url, null, \"GET\", function (responseText) {\r\n        if (typeof cb === 'function')\r\n            cb(responseText);\r\n    });\r\n}\r\n\r\nfunction CreateGroup(parameters: SingleRecord, properties: SingleRecord, cb) {\r\n    //Create Body for GROUP POST\r\n    var data = JSON.stringify({\r\n        \"description\": properties[TeamDescription],\r\n        \"displayName\": properties[TeamDisplayName],\r\n        \"groupTypes\": [\"Unified\"],\r\n        \"mailEnabled\": properties[TeamMailEnabled],\r\n        \"mailNickname\": properties[TeamMailNickname],\r\n        \"visibility\": \"Private\",\r\n        \"securityEnabled\": false\r\n    });\r\n    var url = baseUriEndpoint + \"/groups/\";\r\n    ExecuteRequest(url, data, \"POST\", function (responseText) {\r\n        if (typeof cb === 'function')\r\n            cb(responseText);\r\n    });\r\n}\r\n\r\nfunction CreateTeam(parameters: SingleRecord, properties: SingleRecord, cb) {\r\n    // var data = JSON.stringify({\r\n    //     \"memberSettings\": {\r\n    //         \"allowCreateUpdateChannels\": true\r\n    //     },\r\n    //     \"messagingSettings\": {\r\n    //         \"allowUserEditMessages\": true,\r\n    //         \"allowUserDeleteMessages\": true\r\n    //     },\r\n    //     \"funSettings\": {\r\n    //         \"allowGiphy\": true,\r\n    //         \"giphyContentRating\": \"strict\"\r\n    //     }\r\n    // });\r\n    var data = JSON.stringify({});\r\n    var url = baseUriEndpoint + \"/groups/\" + properties[TeamId] + \"/team\";\r\n    ExecuteRequest(url, data, \"PUT\", function (responseText) {\r\n        if (typeof cb === 'function')\r\n            cb(responseText);\r\n    });\r\n}\r\n\r\nfunction ArchiveTeam(parameters: SingleRecord, properties: SingleRecord, cb) {\r\n    var data = JSON.stringify({\r\n        \"shouldSetSpoSiteReadOnlyForMembers\": true\r\n    });\r\n\r\n    let teamId = properties[TeamId];\r\n    if (!(typeof teamId === \"string\")) throw new Error(\"properties[TeamId] is not of type string\");\r\n\r\n    var url = baseUriEndpoint + \"/teams/\" + encodeURIComponent(teamId) + \"/archive\";\r\n    ExecuteRequest(url, data, \"POST\", function (responseText) {\r\n        if (typeof cb === 'function')\r\n            cb(responseText);\r\n    });\r\n}\r\n\r\nfunction UnarchiveTeam(parameters: SingleRecord, properties: SingleRecord, cb) {\r\n    var data = null;\r\n\r\n    let teamId = properties[TeamId];\r\n    if (!(typeof teamId === \"string\")) throw new Error(\"properties[TeamId] is not of type string\");\r\n\r\n    var url = baseUriEndpoint + \"/teams/\" + encodeURIComponent(teamId) + \"/unarchive\";\r\n    ExecuteRequest(url, data, \"POST\", function (responseText) {\r\n        if (typeof cb === 'function')\r\n            cb(responseText);\r\n    });\r\n}\r\n\r\nfunction UpdateTeam(parameters: SingleRecord, properties: SingleRecord, cb) {\r\n    //TODO - define properties that has to be updated\r\n    var data = JSON.stringify({\r\n        \"memberSettings\": {\r\n            \"allowCreateUpdateChannels\": properties[TeamMsAllowCreateUpdateChannels],\r\n            \"allowDeleteChannels\": properties[TeamMsAllowDeleteChannels],\r\n            \"allowAddRemoveApps\": properties[TeamMsAllowAddRemoveApps],\r\n            \"allowCreateUpdateRemoveTabs\": properties[TeamMsAllowCreateUpdateRemoveTabs],\r\n            \"allowCreateUpdateRemoveConnectors\": properties[TeamMsAllowCreateUpdateRemoveConnectors]\r\n        },\r\n        \"guestSettings\": {\r\n            \"allowCreateUpdateChannels\": properties[TeamGsAllowCreateUpdateChannels],\r\n            \"allowDeleteChannels\": properties[TeamGsAllowDeleteChannels]\r\n        },\r\n        \"messagingSettings\": {\r\n            \"allowUserEditMessages\": properties[TeamMsgAllowUserEditMessages],\r\n            \"allowUserDeleteMessages\": properties[TeamMsgAllowUserDeleteMessages],\r\n            \"allowOwnerDeleteMessages\": properties[TeamMsgAllowUserDeleteMessages],\r\n            \"allowTeamMentions\": properties[TeamMsgAllowTeamMentions],\r\n            \"allowChannelMentions\": properties[TeamMsgAllowChannelMentions]\r\n        },\r\n        \"funSettings\": {\r\n            \"allowGiphy\": properties[TeamFsAllowGiphy],\r\n            \"allowStickersAndMemes\": properties[TeamFsAllowStickersAndMemes],\r\n            \"allowCustomMemes\": properties[TeamFsAllowCustomMemes]\r\n        }\r\n    });\r\n    var url = baseUriEndpoint + \"/teams/\" + properties[TeamId];\r\n    ExecuteRequest(url, data, \"PATCH\", function (responseText) {\r\n        if (typeof cb === 'function')\r\n            cb(responseText);\r\n    });\r\n}\r\n\r\nfunction CloneTeam(parameters: SingleRecord, properties: SingleRecord, cb) {\r\n    var data = JSON.stringify({\r\n        \"displayName\": properties[TeamDisplayName],\r\n        \"description\": properties[TeamDescription],\r\n        \"mailNickname\": properties[TeamMailNickname],\r\n        \"partsToClone\": \"apps,tabs,settings,channels,members\",\r\n        \"visibility\": \"public\"\r\n    });\r\n\r\n    let teamId = properties[TeamId];\r\n    if (!(typeof teamId === \"string\")) throw new Error(\"properties[TeamId] is not of type string\");\r\n\r\n    var url = baseUriEndpoint + \"/teams/\" + encodeURIComponent(teamId) + \"/clone\";\r\n    ExecuteRequest(url, data, \"POST\", function (responseText) {\r\n        if (typeof cb === 'function')\r\n            cb(responseText);\r\n    });\r\n}\r\n\r\nfunction GetUser(parameters: SingleRecord, properties: SingleRecord, cb) {\r\n    let teamUserPrincipalName = properties[TeamUserPrincipalName];\r\n    if (!(typeof teamUserPrincipalName === \"string\")) throw new Error(\"properties[TeamUserPrincipalName] is not of type string\");\r\n\r\n    var url = baseUriEndpoint + \"/users/\" + encodeURIComponent(teamUserPrincipalName);\r\n    ExecuteRequest(url, null, \"GET\", function (responseText) {\r\n        if (typeof cb === 'function')\r\n            cb(responseText);\r\n    });\r\n}\r\n\r\nfunction GetChannelUser(parameters: SingleRecord, properties: SingleRecord, cb) {\r\n    let channelUserPrincipalName = properties[ChannelUserPrincipalName];\r\n    if (!(typeof channelUserPrincipalName === \"string\")) throw new Error(\"properties[ChannelUserPrincipalName] is not of type string\");\r\n\r\n    var url = baseUriEndpoint + \"/users/\" + encodeURIComponent(channelUserPrincipalName);\r\n    ExecuteRequest(url, null, \"GET\", function (responseText) {\r\n        if (typeof cb === 'function')\r\n            cb(responseText);\r\n    });\r\n}\r\n\r\nfunction GetUsers(cb) {\r\n    var url = baseUriEndpoint + \"/users\";\r\n    ExecuteRequest(url, null, \"GET\", function (responseText) {\r\n        if (typeof cb === 'function')\r\n            cb(responseText);\r\n    });\r\n}\r\n\r\nfunction AddGroupOwner(parameters: SingleRecord, properties: SingleRecord, cb) {\r\n    var data = JSON.stringify({\r\n        \"@odata.id\": baseUriEndpoint + \"/users/\" + properties[TeamUserId]\r\n    });\r\n\r\n    let teamId = properties[TeamId];\r\n    if (!(typeof teamId === \"string\")) throw new Error(\"properties[TeamId] is not of type string\");\r\n\r\n    var url = baseUriEndpoint + \"/groups/\" + encodeURIComponent(teamId) + \"/owners/$ref\";\r\n    ExecuteRequest(url, data, \"POST\", function (responseText) {\r\n        if (typeof cb === 'function')\r\n            cb(responseText);\r\n    });\r\n}\r\n\r\nfunction AddGroupMembers(parameters: SingleRecord, properties: SingleRecord, cb) {\r\n    var data = JSON.stringify({\r\n        \"@odata.id\": baseUriEndpoint + \"/directoryObjects/\" + properties[TeamUserId]\r\n    });\r\n\r\n    let teamId = properties[TeamId];\r\n    if (!(typeof teamId === \"string\")) throw new Error(\"properties[TeamId] is not of type string\");\r\n\r\n    var url = baseUriEndpoint + \"/groups/\" + encodeURIComponent(teamId) + \"/members/$ref\";\r\n    ExecuteRequest(url, data, \"POST\", function (responseText) {\r\n        if (typeof cb === 'function')\r\n            cb(responseText);\r\n    });\r\n}\r\n\r\nfunction AddChannelMembers(parameters: SingleRecord, properties: SingleRecord, cb) {\r\n    var data = JSON.stringify({\r\n        \"@odata.type\": \"#microsoft.graph.aadUserConversationMember\",\r\n        \"roles\": [],\r\n        \"user@odata.bind\": baseUriEndpoint + \"/users('\" + properties[ChannelUserId] + \"')\"\r\n    });\r\n\r\n    let teamId = properties[ChannelTeamId];\r\n    let channelId = properties[ChannelId];\r\n\r\n    if (!(typeof teamId === \"string\")) throw new Error(\"properties[ChannelTeamId] is not of type string\");\r\n    if (!(typeof channelId === \"string\")) throw new Error(\"properties[ChannelId] is not of type string\");\r\n\r\n    var url = baseUriEndpointBeta + \"/teams/\" + encodeURIComponent(teamId) + \"/channels/\" + encodeURIComponent(channelId) + \"/members\";\r\n    ExecuteRequest(url, data, \"POST\", function (responseText) {\r\n        if (typeof cb === 'function')\r\n            cb(responseText);\r\n    });\r\n}\r\n\r\nfunction RemoveChannelMember(parameters: SingleRecord, properties: SingleRecord, cb) {\r\n    let teamId = properties[ChannelTeamId];\r\n    if (!(typeof teamId === \"string\")) throw new Error(\"properties[ChannelTeamId] is not of type string\");\r\n\r\n    let channelId = properties[ChannelId];\r\n    if (!(typeof channelId === \"string\")) throw new Error(\"properties[ChannelId] is not of type string\");\r\n\r\n    let channelUserId = properties[ChannelUserId];\r\n    if (!(typeof channelUserId === \"string\")) throw new Error(\"properties[ChannelUserId] is not of type string\");\r\n\r\n    var url = baseUriEndpointBeta + \"/teams/\" + encodeURIComponent(teamId) + \"/channels/\" + encodeURIComponent(channelId) + \"/members/\" + encodeURIComponent(channelUserId);\r\n    ExecuteRequest(url, null, \"DELETE\", function (responseText) {\r\n        if (typeof cb === 'function')\r\n            cb(responseText);\r\n    });\r\n}\r\n\r\n// DELETE /groups/{id}/members/{id}/$ref\r\nfunction RemoveGroupMembers(parameters: SingleRecord, properties: SingleRecord, cb) {\r\n    // var data = JSON.stringify({\r\n    //     \"@odata.id\": baseUriEndpoint + \"/directoryObjects/\" + parameters[TeamUserId]\r\n    // });\r\n\r\n    let teamId = properties[TeamId];\r\n    if (!(typeof teamId === \"string\")) throw new Error(\"properties[TeamId] is not of type string\");\r\n\r\n    let teamUserId = properties[TeamUserId];\r\n    if (!(typeof teamUserId === \"string\")) throw new Error(\"properties[TeamUserId] is not of type string\");\r\n\r\n    var url = baseUriEndpoint + \"/groups/\" + encodeURIComponent(teamId) + \"/members/\" + encodeURIComponent(teamUserId) + \"/$ref\";\r\n    ExecuteRequest(url, null, \"DELETE\", function (responseText) {\r\n        if (typeof cb === 'function')\r\n            cb(responseText);\r\n    });\r\n}\r\n\r\nfunction ExecuteRequest(url: string, data: string, requestType: string, cb) {\r\n    var xhr = new XMLHttpRequest();\r\n    xhr.onreadystatechange = function () {\r\n        console.log(\"ExecuteRequest XHR status: \" + xhr.status + \",\" + xhr.responseText);\r\n        if (xhr.readyState !== 4)\r\n            return;\r\n        if (xhr.status == 201) {\r\n            //console.log(\"ExecuteRequest XHR status: \" + xhr.status + \",\" + xhr.responseText);\r\n            var obj = JSON.parse(xhr.responseText);\r\n            if (typeof cb === 'function')\r\n                cb(obj);\r\n        }\r\n        else if (xhr.status == 204) {\r\n            if (typeof cb === 'function')\r\n                cb(xhr.responseText);\r\n        }\r\n        else if (xhr.status == 200) {\r\n            var obj = JSON.parse(xhr.responseText);\r\n            //console.log(\"ExecuteRequest XHR status: \" + xhr.status + \",\" + xhr.responseText);\r\n            //console.log(\"ExecuteRequest cb type of: \" + (typeof cb).toString());\r\n            if (typeof cb === 'function')\r\n                cb(obj);\r\n        }\r\n        else if (xhr.status == 202) {\r\n            if (typeof cb === 'function')\r\n                cb(null);\r\n        }\r\n        else if (xhr.status == 400) {\r\n            // This is a bad request, return error to UI\r\n            var obj = JSON.parse(xhr.responseText);\r\n            throw new Error(obj.error.code + \": \" + obj.error.message);\r\n        }\r\n        else if (xhr.status == 404) {\r\n            var obj = JSON.parse(xhr.responseText);\r\n            // This is to supress an error that happens with team archive/unarchive\r\n            var errorMessage = obj.error.message;\r\n            if (errorMessage.startswith == \"No Team found with Group id\") {\r\n                // do nothing - supress error\r\n            }\r\n            else {\r\n                throw new Error(obj.error.code + \": \" + obj.error.message);\r\n            }\r\n            //console.log(\"MSTeamsConnector ExecuteRequest: Failed with 404 error.\");\r\n            //throw new Error(obj.error.code + \" error: \" + obj.error.message);\r\n            //console.log(\"Failed with status \" + xhr.status + \" \" + xhr.responseText);\r\n        }\r\n        else {\r\n            postResult({\r\n                //TeamIsSuccessful: false\r\n            });\r\n            var obj = JSON.parse(xhr.responseText);\r\n            throw new Error(obj.error.code + \": \" + obj.error.message);\r\n            //console.log(\"Failed with status \" + xhr.status + \" \" + xhr.responseText);\r\n\r\n        }\r\n    };\r\n    console.log(\"MSTeamsConnector ExecuteRequest: \" + url);\r\n    xhr.open(requestType.toUpperCase(), url);\r\n    // Authentication Header\r\n    xhr.withCredentials = true;\r\n    xhr.setRequestHeader(\"Accept\", \"application/json\");\r\n    if (requestType.toUpperCase() == \"PUT\" || requestType.toUpperCase() == \"POST\" || requestType.toUpperCase() == \"PATCH\") {\r\n        xhr.setRequestHeader(\"Content-Type\", \"application/json\");\r\n    }\r\n    xhr.send(data);\r\n}\r\n\r\nfunction CreateAndReturnTeamObject(parameters: SingleRecord, properties: SingleRecord) {\r\n    postResult({\r\n        [TeamId]: properties[TeamId],\r\n        [TeamDisplayName]: properties[TeamDisplayName],\r\n        [TeamCreationDate]: properties[TeamCreationDate],\r\n        [TeamDescription]: properties[TeamDescription],\r\n        [TeamEmail]: properties[TeamEmail],\r\n        [TeamMailEnabled]: properties[TeamMailEnabled],\r\n        [TeamMailNickname]: properties[TeamMailNickname],\r\n        [TeamWeburl]: properties[TeamWeburl],\r\n        [TeamArchiveStatus]: properties[TeamArchiveStatus],\r\n        [TeamIsSuccessful]: properties[TeamIsSuccessful]\r\n    });\r\n}\r\n\r\nfunction onexecuteTeamAdd(parameters: SingleRecord, properties: SingleRecord) {\r\n    //TODO - Should we make a call to Get Group Details by ID to get the team object details - for returning back to K2 user\r\n    // Add Team to a group\r\n    CreateTeam(parameters, properties, function (b) {\r\n        properties[TeamWeburl] = b.webUrl;\r\n        // Get user\r\n        GetUser(parameters, properties, function (c) {\r\n            properties[TeamUserId] = c.id;\r\n            // Add Owner\r\n            AddGroupOwner(parameters, properties, function (d) {\r\n                // Add Owner As Member\r\n                AddGroupMembers(parameters, properties, function (e) {\r\n                    //Return Team Object\r\n                    CreateAndReturnTeamObject(parameters, properties);\r\n                });\r\n            });\r\n        });\r\n    });\r\n}\r\n\r\nfunction onexecuteTeamUpdate(parameters: SingleRecord, properties: SingleRecord) {\r\n    UpdateTeam(parameters, properties, function (c) {\r\n        if (c.responseText == null || c.responseText == \"\" || c.responseText == undefined || c.responseText == \"undefined\") {\r\n            postResult({\r\n                [TeamIsSuccessful]: true\r\n            });\r\n        }\r\n        //CreateAndReturnTeamObject(parameters, properties);\r\n    });\r\n}\r\n\r\nfunction onexecuteTeamMyTeamsList(parameters: SingleRecord, properties: SingleRecord) {\r\n    GetMyTeams(parameters, properties, function (a) {\r\n        //console.log(a);\r\n        postResult(a.value.map(x => {\r\n            return {\r\n                [TeamId]: x.id,\r\n                [TeamDisplayName]: x.displayName,\r\n                [TeamDescription]: x.description,\r\n                [TeamIsArchived]: x.isArchived\r\n            };\r\n        }));\r\n    });\r\n}\r\n\r\nfunction onexecuteGetDriveRootChildren(parameters: SingleRecord, properties: SingleRecord) {\r\n    GetDriveRootChildren(parameters, properties, function (a) {\r\n        //console.log(a);\r\n        postResult(a.value.map(x => {\r\n            return {\r\n                [DriveChildId]: x.id,\r\n                [DriveChildFolderName]: x.name,\r\n                [DriveChildWebUrl]: x.webUrl\r\n            };\r\n        }));\r\n    });\r\n}\r\n\r\nfunction onexecuteGetSiteLists(parameters: SingleRecord, properties: SingleRecord) {\r\n    GetSiteLists(parameters, properties, function (a) {\r\n        //console.log(a);\r\n        postResult(a.value.map(x => {\r\n            return {\r\n                [SiteListId]: x.id,\r\n                [SiteListName]: x.name,\r\n                [SiteListDisplayName]: x.displayName\r\n            };\r\n        }));\r\n    });\r\n}\r\n\r\nfunction onexecuteTeamList(parameters: SingleRecord, properties: SingleRecord) {\r\n    GetTeams(parameters, properties, function (a) {\r\n        postResult(a.value.map(x => {\r\n            return {\r\n                [TeamId]: x.id,\r\n                [TeamDisplayName]: x.displayName,\r\n                [TeamResourceProvisioningOptions]: x.resourceProvisioningOptions[0]\r\n            };\r\n        }));\r\n    });\r\n}\r\n\r\nfunction GetTeams(parameters: SingleRecord, properties: SingleRecord, cb) {\r\n    if (parameters[TeamDisplayNameStartsWith] == null || parameters[TeamDisplayNameStartsWith] == \"\") {\r\n        let component = \"?$select=id,displayName,resourceProvisioningOptions\";\r\n        var url = baseUriEndpoint + \"/groups\" + component;\r\n    }\r\n    else {\r\n        let teamDisplayNameStartsWith = parameters[TeamDisplayNameStartsWith];\r\n        if (!(typeof teamDisplayNameStartsWith === \"string\")) throw new Error(\"parameters[TeamDisplayNameStartsWith] is not of type string\");\r\n\r\n        let component = \"?$filter=startswith(displayName, '\" + encodeURIComponent(teamDisplayNameStartsWith) + \"')&$select=id,displayName,resourceProvisioningOptions\";\r\n        var url = baseUriEndpoint + \"/groups\" + component;\r\n    }\r\n    ExecuteRequest(url, null, \"GET\", function (responseText) {\r\n        if (typeof cb === 'function')\r\n            cb(responseText);\r\n    });\r\n}\r\n\r\nfunction GetMyTeams(parameters: SingleRecord, properties: SingleRecord, cb) {\r\n    var url = baseUriEndpoint + \"/me/joinedTeams\";\r\n    ExecuteRequest(url, null, \"GET\", function (responseText) {\r\n        if (typeof cb === 'function')\r\n            cb(responseText);\r\n    });\r\n}\r\n\r\nfunction onexecuteTeamArchive(parameters: SingleRecord, properties: SingleRecord) {\r\n    ArchiveTeam(parameters, properties, function (b) {\r\n        // CreateAndReturnTeamObject(parameters, properties);\r\n        postResult({\r\n            [TeamId]: properties[TeamId],\r\n            [TeamRequestStatusUrl]: properties[TeamRequestStatusUrl],\r\n            [TeamIsSuccessful]: properties[TeamIsSuccessful]\r\n        });\r\n    });\r\n}\r\n\r\nfunction onexecuteTeamUnarchive(parameters: SingleRecord, properties: SingleRecord) {\r\n    UnarchiveTeam(parameters, properties, function (b) {\r\n        CreateAndReturnTeamObject(parameters, properties);\r\n        postResult({\r\n            [TeamId]: properties[TeamId],\r\n            [TeamRequestStatusUrl]: properties[TeamRequestStatusUrl],\r\n            [TeamIsSuccessful]: properties[TeamIsSuccessful]\r\n        });\r\n    });\r\n}\r\n\r\nfunction CheckArchivalStatus(parameters: SingleRecord, properties: SingleRecord, cb) {\r\n    var data = null;\r\n\r\n    let teamArchiveOperationUrl = parameters[TeamArchiveOperationUrl];\r\n    if (!(typeof teamArchiveOperationUrl === \"string\")) throw new Error(\"parameters[TeamArchiveOperationUrl] is not of type string\");\r\n\r\n    var url = baseUriEndpoint + \"/\" + encodeURIComponent(teamArchiveOperationUrl);\r\n    ExecuteRequest(url, data, \"GET\", function (responseText) {\r\n        if (typeof cb === 'function')\r\n            cb(responseText);\r\n    });\r\n}\r\n\r\nfunction GetDriveRootChildren(parameters: SingleRecord, properties: SingleRecord, cb) {\r\n    let driveId = properties[DriveId];\r\n    if (!(typeof driveId === \"string\")) throw new Error(\"properties[DriveId] is not of type string\");\r\n\r\n    var url = baseUriEndpoint + \"/sites/root/drives/\" + encodeURIComponent(driveId) + \"/root/children\";\r\n    ExecuteRequest(url, null, \"GET\", function (responseText) {\r\n        if (typeof cb === 'function')\r\n            cb(responseText);\r\n    });\r\n}\r\n\r\nfunction GetSiteLists(parameters: SingleRecord, properties: SingleRecord, cb) {\r\n    let relativePath = properties[SiteRelativePath];\r\n    if (!(typeof relativePath === \"string\")) throw new Error(\"properties[SiteRelativePath] is not of type string\");\r\n\r\n    var url = baseUriEndpoint + \"/sites/root:/\" + encodeURIComponent(relativePath) + \":/lists\";\r\n    ExecuteRequest(url, null, \"GET\", function (responseText) {\r\n        if (typeof cb === 'function')\r\n            cb(responseText);\r\n    });\r\n}\r\n\r\nfunction onexecuteTeamCheckStatus(parameters: SingleRecord, properties: SingleRecord) {\r\n    CheckArchivalStatus(parameters, properties, function (b) {\r\n        postResult({\r\n            [TeamOperationId]: b.id,\r\n            [TeamOperationType]: b.operationType,\r\n            [TeamCreationDate]: b.createdDateTime,\r\n            [TeamArchiveStatus]: b.status,\r\n            [TeamLastActionDate]: b.lastActionDateTime,\r\n            [TeamAttemptsCount]: b.attemptsCount,\r\n            [TeamTargetResourceId]: b.targetResourceId,\r\n            [TeamTargetResourceLocation]: b.targetResourceLocation,\r\n            [TeamArchiveError]: b.error\r\n        });\r\n    });\r\n}\r\n\r\nfunction onexecuteTeamClone(parameters: SingleRecord, properties: SingleRecord) {\r\n    CloneTeam(parameters, properties, function (b) {\r\n        //CreateAndReturnTeamObject(parameters, properties);\r\n        postResult({\r\n            [TeamId]: properties[TeamId],\r\n            [TeamRequestStatusUrl]: properties[TeamRequestStatusUrl],\r\n            [TeamIsSuccessful]: properties[TeamIsSuccessful]\r\n        });\r\n    });\r\n}\r\n\r\nfunction onexecuteChannel(methodName: string, parameters: SingleRecord, properties: SingleRecord) {\r\n    if (properties == null && parameters == null) {\r\n        //do nothing\r\n    }\r\n    else if (properties == null && parameters !== null) {\r\n        parameters[ChannelIsSuccessful] = true;\r\n    }\r\n    else {\r\n        properties[ChannelIsSuccessful] = true;\r\n    }\r\n    switch (methodName) {\r\n        case ChannelGet:\r\n            onexecuteChannelGet(parameters, properties);\r\n            break;\r\n        case ChannelList:\r\n            onexecuteChannelList(parameters, properties);\r\n            break;\r\n        case ChannelCreate:\r\n            onexecuteChannelCreate(parameters, properties);\r\n            break;\r\n        case ChannelDelete:\r\n            onexecuteChannelDelete(parameters, properties);\r\n            break;\r\n        case ChannelUpdate:\r\n            onexecuteChannelUpdate(parameters, properties);\r\n            break;\r\n        case ChannelAddMember:\r\n            onexecuteChannelAddMember(parameters, properties);\r\n            break;\r\n        case ChannelSendMessage:\r\n            onexecuteSendMessage(parameters, properties);\r\n            break;\r\n        case ChannelReplyMessage:\r\n            onexecuteReplyMessage(parameters, properties);\r\n            break;\r\n        case ChannelSendAdaptiveCard:\r\n            onexecuteSendAdaptiveCard(parameters, properties);\r\n            break;\r\n        case ChannelMessages:\r\n            onexecuteGetChannelMessages(parameters, properties);\r\n            break;\r\n        case ChannelGetDrive:\r\n            onexecuteGetChannelDrive(parameters, properties);\r\n            break;\r\n        case ChannelMembers:\r\n            onexecuteGetChannelMembers(parameters, properties);\r\n            break;\r\n        case ChannelRemoveMember:\r\n            onexecuteRemoveChannelMember(parameters, properties);\r\n            break;\r\n        default: throw new Error(\"The channel method \" + methodName + \" is not supported...\");\r\n    }\r\n}\r\n\r\nfunction onexecuteTeamAddMember(parameters: SingleRecord, properties: SingleRecord) {\r\n    GetUser(parameters, properties, function (b) {\r\n        properties[TeamUserPrincipalName] = b.userPrincipalName;\r\n        properties[TeamUserId] = b.id;\r\n        AddGroupMembers(parameters, properties, function (c) {\r\n            //ToDO - remove the if condition and handle in try catch block\r\n            if (c.responseText == null || c.responseText == \"\" || c.responseText == undefined || c.responseText == \"undefined\") {\r\n                postResult({\r\n                    [TeamIsSuccessful]: true\r\n                });\r\n            }\r\n        });\r\n    });\r\n}\r\n\r\nfunction onexecuteChannelAddMember(parameters: SingleRecord, properties: SingleRecord) {\r\n    GetChannelUser(parameters, properties, function (b) {\r\n        properties[ChannelUserPrincipalName] = b.userPrincipalName;\r\n        properties[ChannelUserId] = b.id;\r\n        AddChannelMembers(parameters, properties, function (c) {\r\n            //ToDO - remove the if condition and handle in try catch block\r\n            if (c.responseText == null || c.responseText == \"\" || c.responseText == undefined || c.responseText == \"undefined\") {\r\n                postResult({\r\n                    [ChannelIsSuccessful]: true\r\n                });\r\n            }\r\n        });\r\n    });\r\n}\r\n\r\nfunction onexecuteRemoveChannelMember(parameters: SingleRecord, properties: SingleRecord) {\r\n    RemoveChannelMember(parameters, properties, function (c) {\r\n        //ToDO - remove the if condition and handle in try catch block\r\n        postResult({\r\n            [ChannelIsSuccessful]: true\r\n        });\r\n    });\r\n}\r\n\r\nfunction onexecuteTeamRemoveMember(parameters: SingleRecord, properties: SingleRecord) {\r\n    GetUser(parameters, properties, function (b) {\r\n        properties[TeamUserId] = b.id;\r\n        properties[TeamUserPrincipalName] = b.userPrincipalName;\r\n        RemoveGroupMembers(parameters, properties, function (c) {\r\n            if (c.responseText == null || c.responseText == \"\" || c.responseText == undefined || c.responseText == \"undefined\") {\r\n                postResult({\r\n                    [TeamIsSuccessful]: true\r\n                });\r\n            }\r\n        });\r\n    });\r\n}\r\n\r\nfunction onexecuteTeamAddOwner(parameters: SingleRecord, properties: SingleRecord) {\r\n    GetUser(parameters, properties, function (b) {\r\n        properties[TeamUserId] = b.id;\r\n        properties[TeamUserPrincipalName] = b.userPrincipalName;\r\n        AddGroupOwner(parameters, properties, function (c) {\r\n            // console.log(\"**after AddGroupOwner\" + c.id + \",\" + c.userPrincipalName);\r\n            // var stringValue = String(parameters[TeamAddAsMemberAlso]);\r\n            // var boolValue = stringValue.toLowerCase() == 'true' ? true : false;\r\n            // console.log(boolValue);\r\n            // if (boolValue) {\r\n            //     AddGroupMembers(parameters, properties, function (d) {\r\n            //         if (d.responseText == null || d.responseText == \"\" || d.responseText == undefined || d.responseText == \"undefined\") {\r\n            //             postResult({\r\n            //                 [TeamIsSuccessful]: true\r\n            //             });\r\n            //         }\r\n            //     });\r\n            // }\r\n            // else {\r\n            if (c.responseText == null || c.responseText == \"\" || c.responseText == undefined || c.responseText == \"undefined\") {\r\n                postResult({\r\n                    [TeamIsSuccessful]: true\r\n                });\r\n            }\r\n        });\r\n    });\r\n}\r\n\r\nfunction onexecuteChannelGet(parameters: SingleRecord, properties: SingleRecord) {\r\n    properties[ChannelIsSuccessful] = true;\r\n    GetChannel(parameters, properties, function (a) {\r\n        properties[ChannelId] = a.id,\r\n            properties[ChannelDisplayName] = a.displayName,\r\n            properties[ChannelDescription] = a.description,\r\n            properties[ChannelEmail] = a.email,\r\n            properties[ChannelWeburl] = a.webUrl\r\n        //Post Results\r\n        CreateAndReturnChannelObject(parameters, properties);\r\n    });\r\n}\r\n\r\nfunction onexecuteChannelList(parameters: SingleRecord, properties: SingleRecord) {\r\n    GetChannelList(parameters, properties, function (a) {\r\n        postResult(a.value.map(x => {\r\n            return {\r\n                [ChannelId]: x.id,\r\n                [ChannelDisplayName]: x.displayName,\r\n                [ChannelDescription]: x.description,\r\n                [ChannelEmail]: x.email\r\n            };\r\n        }));\r\n    });\r\n}\r\n\r\nfunction onexecuteGetChannelMembers(parameters: SingleRecord, properties: SingleRecord) {\r\n    GetChannelMembers(parameters, properties, function (a) {\r\n        postResult(a.value.map(x => {\r\n            return {\r\n                [ChannelUserId]: x.userId,\r\n                [ChannelUserName]: x.displayName,\r\n                [ChannelUserPrincipalName]: x.email,\r\n                [ChannelUserMembershipId]: x.id\r\n            };\r\n        }));\r\n    });\r\n}\r\n\r\nfunction onexecuteGetChannelMessages(parameters: SingleRecord, properties: SingleRecord) {\r\n    GetChannelMessages(parameters, properties, function (a) {\r\n        postResult(a.map(x => {\r\n            return {\r\n                [ChannelMessageId]: x.id,\r\n                [ChannelMessageBody]: x.message,\r\n                [ChannelMessageUser]: x.user,\r\n                [ChannelMessageDate]: x.date\r\n            };\r\n        }));\r\n    });\r\n}\r\n\r\nfunction onexecuteChannelCreate(parameters: SingleRecord, properties: SingleRecord) {\r\n    CreateChannel(parameters, properties, function (a) {\r\n        properties[ChannelId] = a.id;\r\n        properties[ChannelDisplayName] = a.displayName;\r\n        properties[ChannelDescription] = a.description;\r\n        properties[ChannelEmail] = a.email;\r\n        properties[ChannelWeburl] = a.webUrl;\r\n        CreateAndReturnChannelObject(parameters, properties);\r\n    });\r\n}\r\n\r\nfunction onexecuteChannelUpdate(parameters: SingleRecord, properties: SingleRecord) {\r\n    UpdateChannel(parameters, properties, function (a) {\r\n        properties[ChannelId] = a.id;\r\n        properties[ChannelDisplayName] = a.displayName;\r\n        properties[ChannelDescription] = a.description;\r\n        properties[ChannelEmail] = a.email;\r\n        properties[ChannelWeburl] = a.webUrl;\r\n        // CreateAndReturnChannelObject(parameters, properties);\r\n        postResult({\r\n            [ChannelIsSuccessful]: true\r\n        });\r\n    });\r\n}\r\n\r\nfunction onexecuteGetChannelDrive(parameters: SingleRecord, properties: SingleRecord) {\r\n    GetChannelDrive(parameters, properties, function (a) {\r\n        postResult({\r\n            [ChannelDriveId]: a.parentReference.driveId,\r\n            [ChannelDriveUrl]: a.webUrl\r\n        });\r\n    });\r\n}\r\n\r\nfunction onexecuteChannelDelete(parameters: SingleRecord, properties: SingleRecord) {\r\n    DeleteChannel(parameters, properties, function (a) {\r\n        postResult({\r\n            [ChannelIsSuccessful]: true\r\n        });\r\n    });\r\n}\r\n\r\nfunction DeleteChannel(parameters: SingleRecord, properties: SingleRecord, cb) {\r\n    let channelTeamId = properties[ChannelTeamId];\r\n    if (!(typeof channelTeamId === \"string\")) throw new Error(\"properties[ChannelTeamId] is not of type string\");\r\n\r\n    let channelId = properties[ChannelId];\r\n    if (!(typeof channelId === \"string\")) throw new Error(\"properties[ChannelId] is not of type string\");\r\n\r\n    var url = baseUriEndpoint + \"/teams/\" + encodeURIComponent(channelTeamId) + \"/channels/\" + encodeURIComponent(channelId);\r\n    ExecuteRequest(url, null, \"DELETE\", function (responseText) {\r\n        if (typeof cb === 'function')\r\n            cb(responseText);\r\n    });\r\n}\r\n\r\nfunction CreateChannel(parameters: SingleRecord, properties: SingleRecord, cb) {\r\n    var data = JSON.stringify({\r\n        \"displayName\": properties[ChannelDisplayName],\r\n        \"description\": properties[ChannelDescription],\r\n        \"membershipType\": properties[MembershipType]\r\n    });\r\n\r\n    let channelTeamId = properties[ChannelTeamId];\r\n    if (!(typeof channelTeamId === \"string\")) throw new Error(\"properties[ChannelTeamId] is not of type string\");\r\n\r\n    var url = baseUriEndpoint + \"/teams/\" + encodeURIComponent(channelTeamId) + \"/channels\";\r\n    ExecuteRequest(url, data, \"POST\", function (responseText) {\r\n        if (typeof cb === 'function')\r\n            cb(responseText);\r\n    });\r\n}\r\n\r\nfunction CreateAndReturnChannelObject(parameters: SingleRecord, properties: SingleRecord) {\r\n    //var ChannelId = String(properties[ChannelId]);\r\n    // if (ChannelId == null || ChannelId == \"undefined\" || ChannelId == \"\" || ChannelId == undefined)\r\n    //     parameters[ChannelId] = properties[ChannelId];\r\n    postResult({\r\n        [ChannelId]: properties[ChannelId],\r\n        [ChannelDisplayName]: properties[ChannelDisplayName],\r\n        [ChannelDescription]: properties[ChannelDescription],\r\n        [ChannelEmail]: properties[ChannelEmail],\r\n        [ChannelWeburl]: properties[ChannelWeburl],\r\n        [ChannelIsSuccessful]: properties[ChannelIsSuccessful]\r\n    });\r\n}\r\n\r\nfunction GetChannel(parameters: SingleRecord, properties: SingleRecord, cb) {\r\n    let channelTeamId = properties[ChannelTeamId];\r\n    if (!(typeof channelTeamId === \"string\")) throw new Error(\"properties[ChannelTeamId] is not of type string\");\r\n\r\n    let channelId = properties[ChannelId];\r\n    if (!(typeof channelId === \"string\")) throw new Error(\"properties[ChannelId] is not of type string\");\r\n\r\n    var url = baseUriEndpoint + \"/teams/\" + encodeURIComponent(channelTeamId) + \"/channels/\" + encodeURIComponent(channelId);\r\n    ExecuteRequest(url, null, \"GET\", function (responseText) {\r\n        if (typeof cb === 'function')\r\n            cb(responseText);\r\n    });\r\n}\r\n\r\nfunction GetChannelDrive(parameters: SingleRecord, properties: SingleRecord, cb) {\r\n    let channelTeamId = properties[ChannelTeamId];\r\n    if (!(typeof channelTeamId === \"string\")) throw new Error(\"properties[ChannelTeamId] is not of type string\");\r\n\r\n    let channelId = properties[ChannelId];\r\n    if (!(typeof channelId === \"string\")) throw new Error(\"properties[ChannelId] is not of type string\");\r\n\r\n    var url = baseUriEndpoint + \"/teams/\" + encodeURIComponent(channelTeamId) + \"/channels/\" + encodeURIComponent(channelId) + \"/filesFolder\";\r\n    ExecuteRequest(url, null, \"GET\", function (responseText) {\r\n        if (typeof cb === 'function')\r\n            cb(responseText);\r\n    });\r\n}\r\n\r\nfunction GetChannelList(parameters: SingleRecord, properties: SingleRecord, cb) {\r\n    let channelTeamId = properties[ChannelTeamId];\r\n    if (!(typeof channelTeamId === \"string\")) throw new Error(\"properties[ChannelTeamId] is not of type string\");\r\n\r\n    var url = baseUriEndpoint + \"/teams/\" + encodeURIComponent(channelTeamId) + \"/channels?$select=id, displayname, description, email\";\r\n    ExecuteRequest(url, null, \"GET\", function (responseText) {\r\n        if (typeof cb === 'function')\r\n            cb(responseText);\r\n    });\r\n}\r\n\r\nfunction GetChannelMembers(parameters: SingleRecord, properties: SingleRecord, cb) {\r\n    let channelTeamId = properties[ChannelTeamId];\r\n    if (!(typeof channelTeamId === \"string\")) throw new Error(\"properties[ChannelTeamId] is not of type string\");\r\n\r\n    let channelId = properties[ChannelId];\r\n    if (!(typeof channelId === \"string\")) throw new Error(\"properties[ChannelId] is not of type string\");\r\n\r\n    var url = baseUriEndpointBeta + \"/teams/\" + encodeURIComponent(channelTeamId) + \"/channels/\" + encodeURIComponent(channelId) + \"/members\";\r\n    ExecuteRequest(url, null, \"GET\", function (responseText) {\r\n        if (typeof cb === 'function')\r\n            cb(responseText);\r\n    });\r\n}\r\n\r\nfunction GetChannelMessages(parameters: SingleRecord, properties: SingleRecord, cb) {\r\n    //console.log(`GetChannelMessages Started: Team ID:${properties[ChannelTeamId]} Channel ID:${properties[ChannelId]}`);\r\n    let channelTeamId = properties[ChannelTeamId];\r\n\r\n    if (!(typeof channelTeamId === \"string\")) throw new Error(\"properties[ChannelTeamId] is not of type string\");\r\n\r\n    let channelId = properties[ChannelId];\r\n    if (!(typeof channelId === \"string\")) throw new Error(\"properties[ChannelId] is not of type string\");\r\n\r\n    var url = baseUriEndpointBeta + \"/teams/\" + encodeURIComponent(channelTeamId) + \"/channels/\" + encodeURIComponent(channelId) + \"/messages\";\r\n\r\n    ExecuteRequest(url, null, \"GET\", function (responseText) {\r\n        if (typeof cb === 'function') {\r\n            //console.log(`GET Succeeded: ${responseText}`);\r\n            var messages = responseText.value.map(x => { return { \"id\": x.id, \"message\": GetCleanedMessage(x), \"user\": x.from.user.displayName, \"date\": x.createdDateTime } })\r\n            //console.log(messages);\r\n            cb(messages);\r\n        }\r\n    });\r\n}\r\n\r\nfunction GetCleanedMessage(messageObject) {\r\n    var message = messageObject.body.content;\r\n\r\n    if (message.indexOf('<attachment id=\"74d20c7f34aa4a7fb74e2b30004247c5\"></attachment>') > -1) {\r\n        var tempMessage = \"\";\r\n        var card = messageObject.attachments[0].content;\r\n        var cardObject = JSON.parse(card);\r\n\r\n        if (cardObject.body != undefined) {\r\n            cardObject.body.forEach(b => {\r\n                if (b.type == \"ColumnSet\") {\r\n                    b.columns.forEach(c => {\r\n                        c.items.forEach(i => {\r\n                            if (i.type == \"TextBlock\") {\r\n                                var startTag = i.size != undefined && i.size == \"large\" ? \"<h3>\" : \"<span>\";\r\n                                var boldStartTag = i.weight != undefined && i.weight == \"bolder\" ? \"<b>\" : \"\";\r\n                                var boldEndTag = boldStartTag == \"<b>\" ? \"</b>\" : \"\";\r\n                                var endTag = startTag == \"<h3>\" ? \"</h3>\" : \"</span>\";\r\n\r\n                                tempMessage += `<div class='teams-message-row'>${startTag}${boldStartTag}${i.text}${boldEndTag}${endTag}</div>`;\r\n                            }\r\n                        });\r\n                    });\r\n                }\r\n            });\r\n        } else {\r\n            message = cardObject.text;\r\n        }\r\n        message = message.replace('<attachment id=\"74d20c7f34aa4a7fb74e2b30004247c5\"></attachment>', tempMessage);\r\n    }\r\n\r\n    message = message.replace(\"<at\", \"<b\").replace(\"</at>\", \"</b>\");\r\n\r\n    return message;\r\n}\r\n\r\nfunction UpdateChannel(parameters: SingleRecord, properties: SingleRecord, cb) {\r\n    var data = JSON.stringify({\r\n        \"displayName\": properties[ChannelDisplayName],\r\n        \"description\": properties[ChannelDescription]\r\n        //\"email\": \"test@k2rocks.com\" TODO: Pass the correct parameter here\r\n    });\r\n\r\n    let channelTeamId = properties[ChannelTeamId];\r\n    if (!(typeof channelTeamId === \"string\")) throw new Error(\"properties[ChannelTeamId] is not of type string\");\r\n\r\n    let channelId = properties[ChannelId];\r\n    if (!(typeof channelId === \"string\")) throw new Error(\"properties[ChannelId] is not of type string\");\r\n\r\n    var url = baseUriEndpoint + \"/teams/\" + encodeURIComponent(channelTeamId) + \"/channels/\" + encodeURIComponent(channelId);\r\n    ExecuteRequest(url, data, \"PATCH\", function (responseText) {\r\n        if (typeof cb === 'function')\r\n            cb(responseText);\r\n    });\r\n}\r\n\r\nfunction onexecuteSendMessage(parameters: SingleRecord, properties: SingleRecord) {\r\n    SendMessage(parameters, properties, function (a) {\r\n        postResult({\r\n            [ChannelIsSuccessful]: true,\r\n            [ChannelMessageId]: a.id\r\n        });\r\n    });\r\n}\r\n\r\nfunction onexecuteSendAdaptiveCard(parameters: SingleRecord, properties: SingleRecord) {\r\n    SendAdaptiveCard(parameters, properties, function (a) {\r\n        postResult({\r\n            [ChannelIsSuccessful]: true,\r\n            [ChannelMessageId]: a.id\r\n        });\r\n    });\r\n}\r\n\r\nfunction SendAdaptiveCard(parameters: SingleRecord, properties: SingleRecord, cb) {\r\n    let channelTeamId = properties[ChannelTeamId];\r\n    if (!(typeof channelTeamId === \"string\")) throw new Error(\"properties[ChannelTeamId] is not of type string\");\r\n\r\n    let channelId = properties[ChannelId];\r\n    if (!(typeof channelId === \"string\")) throw new Error(\"properties[ChannelId] is not of type string\");\r\n\r\n    var data = JSON.stringify(\r\n        {\r\n            \"subject\": null,\r\n            \"body\": {\r\n                \"contentType\": \"html\",\r\n                \"content\": \"<attachment id=\\\"74d20c7f34aa4a7fb74e2b30004247c5\\\"></attachment>\"\r\n            },\r\n            \"attachments\": [\r\n                {\r\n                    \"id\": \"74d20c7f34aa4a7fb74e2b30004247c5\",\r\n                    \"contentType\": \"application/vnd.microsoft.card.adaptive\",\r\n                    \"content\": properties[ChannelMessageBody].toString()\r\n                }\r\n            ]\r\n        }\r\n    );\r\n\r\n    var url = baseUriEndpointBeta + \"/teams/\" + encodeURIComponent(channelTeamId) + \"/channels/\" + encodeURIComponent(channelId) + \"/messages\";\r\n    ExecuteRequest(url, data, \"POST\", function (responseText) {\r\n        if (typeof cb === 'function')\r\n            cb(responseText);\r\n    });\r\n}\r\n\r\nfunction SendMessage(parameters: SingleRecord, properties: SingleRecord, cb) {\r\n    if (properties[ChannelMessageBody].toString().indexOf(\"<at\") > -1) {\r\n        GetUsers(function (u) {\r\n            var importance = properties[ChannelMessageIsImportant] == \"true\" ? \"High\" : \"Normal\";\r\n            var obj = {\r\n                \"subject\": properties[ChannelMessageSubject],\r\n                \"importance\": importance.toString(),\r\n                \"body\": {\r\n                    \"contentType\": \"html\",\r\n                    \"content\": properties[ChannelMessageBody]\r\n                },\r\n                \"mentions\": []\r\n            };\r\n\r\n            if (properties[ChannelMessageBody].toString().indexOf(\"<at\") > -1) {\r\n                obj.mentions = GetMentions(properties, properties[ChannelMessageBody], u);\r\n            }\r\n\r\n            var data = JSON.stringify(obj);\r\n\r\n            let channelTeamId = properties[ChannelTeamId];\r\n            if (!(typeof channelTeamId === \"string\")) throw new Error(\"properties[ChannelTeamId] is not of type string\");\r\n\r\n            let channelId = properties[ChannelId];\r\n            if (!(typeof channelId === \"string\")) throw new Error(\"properties[ChannelId] is not of type string\");\r\n\r\n            var url = baseUriEndpointBeta + \"/teams/\" + encodeURIComponent(channelTeamId) + \"/channels/\" + encodeURIComponent(channelId) + \"/messages\";\r\n            ExecuteRequest(url, data, \"POST\", function (responseText) {\r\n                if (typeof cb === 'function')\r\n                    cb(responseText);\r\n            });\r\n        });\r\n    }\r\n    else {\r\n        var importance = properties[ChannelMessageIsImportant] == \"true\" ? \"High\" : \"Normal\";\r\n        var data = JSON.stringify({\r\n            \"subject\": properties[ChannelMessageSubject],\r\n            \"importance\": importance.toString(),\r\n            \"body\": {\r\n                \"contentType\": \"html\",\r\n                \"content\": properties[ChannelMessageBody]\r\n            }\r\n        });\r\n\r\n        let channelTeamId = properties[ChannelTeamId];\r\n        if (!(typeof channelTeamId === \"string\")) throw new Error(\"properties[ChannelTeamId] is not of type string\");\r\n\r\n        let channelId = properties[ChannelId];\r\n        if (!(typeof channelId === \"string\")) throw new Error(\"properties[ChannelId] is not of type string\");\r\n\r\n        var url = baseUriEndpointBeta + \"/teams/\" + encodeURIComponent(channelTeamId) + \"/channels/\" + encodeURIComponent(channelId) + \"/messages\";\r\n        ExecuteRequest(url, data, \"POST\", function (responseText) {\r\n            if (typeof cb === 'function')\r\n                cb(responseText);\r\n        });\r\n    }\r\n}\r\n\r\nfunction GetMentions(properties, message, payload) {\r\n    var mentions = [];\r\n    var users = payload.value;\r\n    var matches = message.match(/<at[^>]*>.*?<\\/at>/gm);\r\n\r\n    for (let i = 0; i < matches.length; i++) {\r\n        var displayName = matches[i].replace(/<[^>]+>/g, '');\r\n        var user = users.filter(function (item) { return item.displayName == displayName })\r\n\r\n        var mentionObj = {\r\n            \"id\": i,\r\n            \"mentionText\": displayName,\r\n            \"mentioned\": {\r\n                \"application\": null,\r\n                \"device\": null,\r\n                \"conversation\": null,\r\n                \"user\": {\r\n                    \"id\": user[0].id,\r\n                    \"displayName\": displayName,\r\n                    \"userIdentityType\": \"aadUser\"\r\n                }\r\n            }\r\n        };\r\n        mentions.push(mentionObj);\r\n    }\r\n\r\n    return mentions;\r\n}\r\n\r\nfunction onexecuteReplyMessage(parameters: SingleRecord, properties: SingleRecord) {\r\n    ReplyMessage(parameters, properties, function (a) {\r\n        postResult({\r\n            [ChannelIsSuccessful]: true\r\n        });\r\n    });\r\n}\r\n\r\nfunction ReplyMessage(parameters: SingleRecord, properties: SingleRecord, cb) {\r\n    var data = JSON.stringify({\r\n        \"body\": {\r\n            \"contentType\": \"html\",\r\n            \"content\": properties[ChannelMessageBody]\r\n        }\r\n    });\r\n\r\n    let channelTeamId = properties[ChannelTeamId];\r\n    if (!(typeof channelTeamId === \"string\")) throw new Error(\"properties[ChannelTeamId] is not of type string\");\r\n\r\n    let channelId = properties[ChannelId];\r\n    if (!(typeof channelId === \"string\")) throw new Error(\"properties[ChannelId] is not of type string\");\r\n\r\n    let channelMessageId = properties[ChannelMessageId];\r\n    if (!(typeof channelMessageId === \"string\")) throw new Error(\"properties[ChannelMessageId] is not of type string\");\r\n\r\n    var url = baseUriEndpointBeta + \"/teams/\" + encodeURIComponent(channelTeamId) + \"/channels/\" + encodeURIComponent(channelId) + \"/messages/\" + + encodeURIComponent(channelMessageId) + \"/replies\";\r\n    ExecuteRequest(url, data, \"POST\", function (responseText) {\r\n        if (typeof cb === 'function')\r\n            cb(responseText);\r\n    });\r\n}\r\n\r\nfunction onexecuteTabGet(parameters: SingleRecord, properties: SingleRecord) {\r\n    GetTabInformation(parameters, properties, function (a) {\r\n        postResult({\r\n            [TabId]: a.id,\r\n            [TabDisplayName]: a.displayName,\r\n            [TabConfigEntityId]: a.configuration.entityId,\r\n            [TabConfigContentUrl]: a.configuration.contentUrl,\r\n            [TabConfigWebsiteUrl]: a.configuration.websiteUrl,\r\n            [TabConfigRemoveUrl]: a.configuration.removeUrl,\r\n            [TabTeamsAppAppId]: a.teamsApp.id,\r\n            [TabTeamsAppExternalId]: a.teamsApp.externalId,\r\n            [TabTeamsAppAppDisplayName]: a.teamsApp.displayName,\r\n            [TabTeamsAppDistMethod]: a.teamsApp.distributionMethod,\r\n            [TabSortOrderIndex]: a.sortOrderIndex,\r\n            [TabWeburl]: a.webUrl\r\n        });\r\n    });\r\n}\r\n\r\nfunction GetTabInformation(parameters: SingleRecord, properties: SingleRecord, cb) {\r\n    let tabTeamId = properties[TabTeamId];\r\n    if (!(typeof tabTeamId === \"string\")) throw new Error(\"properties[TabTeamId] is not of type string\");\r\n\r\n    let tabChannelId = properties[TabChannelId];\r\n    if (!(typeof tabChannelId === \"string\")) throw new Error(\"properties[TabChannelId] is not of type string\");\r\n\r\n    let tabId = properties[TabId];\r\n    if (!(typeof tabId === \"string\")) throw new Error(\"properties[TabId] is not of type string\");\r\n\r\n    var url = baseUriEndpoint + \"/teams/\" + encodeURIComponent(tabTeamId) + \"/Channels/\" + encodeURIComponent(tabChannelId) + \"/tabs/\" + encodeURIComponent(tabId) + \"?$expand=teamsApp\";\r\n    ExecuteRequest(url, null, \"GET\", function (responseText) {\r\n        if (typeof cb === 'function')\r\n            cb(responseText);\r\n    });\r\n}\r\n\r\nfunction onexecuteTabUpdate(parameters: SingleRecord, properties: SingleRecord) {\r\n    UpdateTab(parameters, properties, function (a) {\r\n        postResult({\r\n            [TabIsSuccessful]: true\r\n        });\r\n    });\r\n}\r\n\r\nfunction UpdateTab(parameters: SingleRecord, properties: SingleRecord, cb) {\r\n    var data = JSON.stringify({\r\n        \"displayName\": properties[TabDisplayName],\r\n        \"contentUrl\": properties[TabConfigContentUrl],\r\n        \"removeUrl\": properties[TabConfigRemoveUrl],\r\n        \"websiteUrl\": properties[TabConfigWebsiteUrl],\r\n    });\r\n\r\n    let tabTeamId = properties[TabTeamId];\r\n    if (!(typeof tabTeamId === \"string\")) throw new Error(\"properties[TabTeamId] is not of type string\");\r\n\r\n    let tabChannelId = properties[TabChannelId];\r\n    if (!(typeof tabChannelId === \"string\")) throw new Error(\"properties[TabChannelId] is not of type string\");\r\n\r\n    let tabId = properties[TabId];\r\n    if (!(typeof tabId === \"string\")) throw new Error(\"properties[TabId] is not of type string\");\r\n\r\n    var url = baseUriEndpoint + \"/teams/\" + encodeURIComponent(tabTeamId) + \"/Channels/\" + encodeURIComponent(tabChannelId) + \"/tabs/\" + encodeURIComponent(tabId);\r\n    ExecuteRequest(url, data, \"PATCH\", function (responseText) {\r\n        if (typeof cb === 'function')\r\n            cb(responseText);\r\n    });\r\n}\r\n\r\nfunction onexecuteTabList(parameters: SingleRecord, properties: SingleRecord) {\r\n    GetTabList(parameters, properties, function (a) {\r\n        postResult(a.value.map(x => {\r\n            return {\r\n                [TabId]: x.id,\r\n                [TabDisplayName]: x.displayName,\r\n                [TabWeburl]: x.webUrl\r\n            };\r\n        }));\r\n    });\r\n}\r\n\r\nfunction onexecuteTabCreate(methodName: string, parameters: SingleRecord, properties: SingleRecord) {\r\n    switch (methodName) {\r\n        case TabCreateWordTab:\r\n            prepareDataAndCreateTab(parameters, properties, getRequestBody(\"Word\", properties));\r\n            break;\r\n        case TabCreateExcelTab:\r\n            prepareDataAndCreateTab(parameters, properties, getRequestBody(\"Excel\", properties));\r\n            break;\r\n        case TabCreatePowerPointTab:\r\n            prepareDataAndCreateTab(parameters, properties, getRequestBody(\"PowerPoint\", properties));\r\n            break;\r\n        case TabCreatePdfTab:\r\n            prepareDataAndCreateTab(parameters, properties, getRequestBody(\"PDF\", properties));\r\n            break;\r\n        case TabCreateOneNoteTab:\r\n            prepareDataAndCreateTab(parameters, properties, getRequestBody(\"OneNote\", properties));\r\n            break;\r\n        case TabCreatePlannerTab:\r\n            prepareDataAndCreateTab(parameters, properties, getRequestBody(\"Planner\", properties));\r\n            break;\r\n        case TabCreateSharePointTab:\r\n            prepareDataAndCreateTab(parameters, properties, getRequestBody(\"SharePoint\", properties));\r\n            break;\r\n        case TabCreateMsFormsTab:\r\n            prepareDataAndCreateTab(parameters, properties, getRequestBody(\"MicrosoftForms\", properties));\r\n            break;\r\n        case TabCreateMsStreamTab:\r\n            prepareDataAndCreateTab(parameters, properties, getRequestBody(\"MicrosoftStream\", properties));\r\n            break;\r\n        case TabCreateWebsiteTab:\r\n            prepareDataAndCreateTab(parameters, properties, getRequestBody(\"Website\", properties));\r\n            break;\r\n        case TabCreateWikiTab:\r\n            prepareDataAndCreateTab(parameters, properties, getRequestBody(\"Wiki\", properties));\r\n            break;\r\n        case TabCreatePowerBiTab:\r\n            prepareDataAndCreateTab(parameters, properties, getRequestBody(\"PowerBI\", properties));\r\n            break;\r\n        case TabCreateDocumentLibraryTab:\r\n            prepareDataAndCreateTab(parameters, properties, getRequestBody(\"DocumentLibrary\", properties));\r\n            break;\r\n        case TabCreateCustomTab:\r\n            prepareDataAndCreateTab(parameters, properties, getRequestBody(\"Custom\", properties));\r\n            break;\r\n        default: throw new Error(\"The object \" + methodName + \" is not supported.\");\r\n    }\r\n}\r\n\r\n\r\nfunction prepareDataAndCreateTab(parameters: SingleRecord, properties: SingleRecord, requestBody) {\r\n    requestBody.configuration = {\r\n        \"entityId\": properties[TabConfigEntityId],\r\n        \"contentUrl\": properties[TabConfigContentUrl],\r\n        \"removeUrl\": properties[TabConfigRemoveUrl],\r\n        \"websiteUrl\": properties[TabConfigWebsiteUrl]\r\n    };\r\n\r\n    CreateTab(parameters, properties, JSON.stringify(requestBody), function (a) {\r\n        // CreateAndReturnChannelObject(parameters, properties);\r\n        postResult({\r\n            [TabId]: a.id,\r\n            [TabDisplayName]: a.displayName,\r\n            [TabWeburl]: a.webUrl,\r\n            [TabConfigEntityId]: a.configuration.entityId,\r\n            [TabConfigContentUrl]: a.configuration.contentUrl,\r\n            [TabConfigWebsiteUrl]: a.configuration.websiteUrl,\r\n            [TabConfigRemoveUrl]: a.configuration.removeUrl,\r\n            [TabIsSuccessful]: true\r\n        });\r\n    });\r\n}\r\n\r\nfunction CreateTab(parameters: SingleRecord, properties: SingleRecord, data: string, cb) {\r\n    let tabTeamId = properties[TabTeamId];\r\n    if (!(typeof tabTeamId === \"string\")) throw new Error(\"properties[TabTeamId] is not of type string\");\r\n\r\n    let tabChannelId = properties[TabChannelId];\r\n    if (!(typeof tabChannelId === \"string\")) throw new Error(\"properties[TabChannelId] is not of type string\");\r\n\r\n    var url = baseUriEndpoint + \"/teams/\" + encodeURIComponent(tabTeamId) + \"/channels/\" + encodeURIComponent(tabChannelId) + \"/tabs\";\r\n    ExecuteRequest(url, data, \"POST\", function (responseText) {\r\n        if (typeof cb === 'function')\r\n            cb(responseText);\r\n    });\r\n}\r\n\r\nfunction getRequestBody(tabType: string, properties) {\r\n    var data;\r\n    switch (tabType) {\r\n        case \"Word\":\r\n            data = {\r\n                \"displayName\": properties[TabDisplayName],\r\n                \"teamsApp@odata.bind\": \"https://graph.microsoft.com/v1.0/appCatalogs/teamsApps/com.microsoft.teamspace.tab.file.staticviewer.word\"\r\n            };\r\n            break;\r\n        case \"Excel\":\r\n            data = {\r\n                \"displayName\": properties[TabDisplayName],\r\n                \"teamsApp@odata.bind\": \"https://graph.microsoft.com/v1.0/appCatalogs/teamsApps/com.microsoft.teamspace.tab.file.staticviewer.excel\"\r\n            };\r\n            break;\r\n        case \"Powerpoint\":\r\n            data = {\r\n                \"displayName\": properties[TabDisplayName],\r\n                \"teamsApp@odata.bind\": \"https://graph.microsoft.com/v1.0/appCatalogs/teamsApps/com.microsoft.teamspace.tab.file.staticviewer.powerpoint\"\r\n            };\r\n            break;\r\n        case \"PDF\":\r\n            data = {\r\n                \"displayName\": properties[TabDisplayName],\r\n                \"teamsApp@odata.bind\": \"https://graph.microsoft.com/v1.0/appCatalogs/teamsApps/com.microsoft.teamspace.tab.file.staticviewer.pdf\"\r\n            };\r\n            break;\r\n        case \"OneNote\":\r\n            data = {\r\n                \"displayName\": properties[TabDisplayName],\r\n                \"teamsApp@odata.bind\": \"https://graph.microsoft.com/v1.0/appCatalogs/teamsApps/0d820ecd-def2-4297-adad-78056cde7c78\"\r\n            };\r\n            break;\r\n        case \"Planner\":\r\n            data = {\r\n                \"displayName\": properties[TabDisplayName],\r\n                \"teamsApp@odata.bind\": \"https://graph.microsoft.com/v1.0/appCatalogs/teamsApps/com.microsoft.teamspace.tab.planner\"\r\n            };\r\n            break;\r\n        case \"SharePoint\":\r\n            data = {\r\n                \"displayName\": properties[TabDisplayName],\r\n                \"teamsApp@odata.bind\": \"https://graph.microsoft.com/v1.0/appCatalogs/teamsApps/2a527703-1f6f-4559-a332-d8a7d288cd88\"\r\n            };\r\n            break;\r\n        case \"MicrosoftForms\":\r\n            data = {\r\n                \"displayName\": properties[TabDisplayName],\r\n                \"teamsApp@odata.bind\": \"https://graph.microsoft.com/v1.0/appCatalogs/teamsApps/81fef3a6-72aa-4648-a763-de824aeafb7d\"\r\n            };\r\n            break;\r\n        case \"MicrosoftStream\":\r\n            data = {\r\n                \"displayName\": properties[TabDisplayName],\r\n                \"teamsApp@odata.bind\": \"https://graph.microsoft.com/v1.0/appCatalogs/teamsApps/com.microsoftstream.embed.skypeteamstab\"\r\n            };\r\n            break;\r\n        case \"Website\":\r\n            data = {\r\n                \"displayName\": properties[TabDisplayName],\r\n                \"teamsApp@odata.bind\": \"https://graph.microsoft.com/v1.0/appCatalogs/teamsApps/com.microsoft.teamspace.tab.web\"\r\n            };\r\n            break;\r\n        case \"Wiki\":\r\n            data = {\r\n                \"displayName\": properties[TabDisplayName],\r\n                \"teamsApp@odata.bind\": \"https://graph.microsoft.com/v1.0/appCatalogs/teamsApps/com.microsoft.teamspace.tab.wiki\"\r\n            };\r\n            break;\r\n        case \"PowerBI\":\r\n            data = {\r\n                \"displayName\": properties[TabDisplayName],\r\n                \"teamsApp@odata.bind\": \"https://graph.microsoft.com/v1.0/appCatalogs/teamsApps/com.microsoft.teamspace.tab.powerbi\"\r\n            };\r\n            break;\r\n        case \"DocumentLibrary\":\r\n            data = {\r\n                \"displayName\": properties[TabDisplayName],\r\n                \"teamsApp@odata.bind\": \"https://graph.microsoft.com/v1.0/appCatalogs/teamsApps/com.microsoft.teamspace.tab.files.sharepoint\"\r\n            };\r\n            break;\r\n        case \"Custom\":\r\n            data = {\r\n                \"displayName\": properties[TabDisplayName],\r\n                \"teamsApp@odata.bind\": \"https://graph.microsoft.com/v1.0/appCatalogs/teamsApps/\" + properties[TabTeamsAppAppId]\r\n            };\r\n            break;\r\n        default: throw new Error(\"Tab Type is not supported or app is not installed!\");\r\n    }\r\n    return data;\r\n}\r\n\r\nfunction onexecuteTabDelete(parameters: SingleRecord, properties: SingleRecord) {\r\n    DeleteTab(parameters, properties, function (a) {\r\n        if (a == null || a == \"\") {\r\n            postResult({\r\n                [TabIsSuccessful]: true\r\n            });\r\n        }\r\n    });\r\n}\r\n\r\nfunction DeleteTab(parameters: SingleRecord, properties: SingleRecord, cb) {\r\n    let tabTeamId = properties[TabTeamId];\r\n    if (!(typeof tabTeamId === \"string\")) throw new Error(\"properties[TabTeamId] is not of type string\");\r\n\r\n    let tabChannelId = properties[TabChannelId];\r\n    if (!(typeof tabChannelId === \"string\")) throw new Error(\"properties[TabChannelId] is not of type string\");\r\n\r\n    let tabId = properties[TabId];\r\n    if (!(typeof tabId === \"string\")) throw new Error(\"properties[TabId] is not of type string\");\r\n\r\n    var url = baseUriEndpoint + \"/teams/\" + encodeURIComponent(tabTeamId) + \"/Channels/\" + encodeURIComponent(tabChannelId) + \"/tabs/\" + encodeURIComponent(tabId);\r\n    ExecuteRequest(url, null, \"DELETE\", function (responseText) {\r\n        if (typeof cb === 'function')\r\n            cb(responseText);\r\n    });\r\n}\r\n\r\n\r\nfunction GetInstalledAppList(parameters: SingleRecord, properties: SingleRecord, cb) {\r\n    let appTeamId = properties[AppTeamId];\r\n    if (!(typeof appTeamId === \"string\")) throw new Error(\"properties[AppTeamId] is not of type string\");\r\n\r\n    var url = baseUriEndpoint + \"/teams/\" + encodeURIComponent(appTeamId) + \"/installedApps?$expand=teamsAppDefinition\";\r\n    ExecuteRequest(url, null, \"GET\", function (responseText) {\r\n        if (typeof cb === 'function')\r\n            cb(responseText);\r\n    });\r\n}\r\n\r\n\r\nfunction onexecuteInstalledAppList(parameters: SingleRecord, properties: SingleRecord) {\r\n    GetInstalledAppList(parameters, properties, function (a) {\r\n        postResult(a.value.map(x => {\r\n            return {\r\n                [AppId]: x.id,\r\n                [AppDisplayName]: x.teamsAppDefinition.displayName,\r\n                [AppVersion]: x.teamsAppDefinition.version,\r\n                [AppTeamAppDefinitionId]: x.teamsAppDefinition.id,\r\n                [AppTeamsAppId]: x.teamsAppDefinition.teamsAppId\r\n            };\r\n        }));\r\n    });\r\n}\r\n\r\nfunction onexecutePolicySet(parameters: SingleRecord, properties: SingleRecord) {\r\n    SetTokenPolicy(parameters, properties, function (a) {\r\n        postResult({ [TokenUpdateSuccess]: a.TokenUpdateSuccess });\r\n    });\r\n}\r\n\r\nfunction SetTokenPolicy(parameters: SingleRecord, properties: SingleRecord, cb) {\r\n    let tokenLifetime = properties[TokenLifetime];\r\n    let policyDisplayName = properties[TokenPolicyDisplayName];\r\n    let isOrgDefault = properties[TokenOrganizationDefault].toString() == \"true\";\r\n\r\n    if (!(typeof tokenLifetime === \"string\")) throw new Error(\"properties[TokenLifetime] is not of type string\");\r\n    if (!(typeof policyDisplayName === \"string\")) throw new Error(\"properties[TokenPolicyDisplayName] is not of type string\");\r\n\r\n    var data = JSON.stringify({\r\n        \"definition\": [\r\n            \"{\\\"TokenLifetimePolicy\\\":{\\\"Version\\\":1,\\\"AccessTokenLifetime\\\":\\\"\" + tokenLifetime + \"\\\"}}\"\r\n        ],\r\n        \"displayName\": policyDisplayName,\r\n        \"isOrganizationDefault\": isOrgDefault\r\n    });\r\n\r\n    var url = baseUriEndpointBeta + \"/policies/tokenLifetimePolicies\";\r\n    ExecuteRequest(url, data, \"POST\", function (responseText) {\r\n        if (typeof cb === 'function')\r\n            cb({ TokenUpdateSuccess: true });\r\n    });\r\n}\r\n\r\nfunction GetTabList(parameters: SingleRecord, properties: SingleRecord, cb) {\r\n    let tabTeamId = properties[TabTeamId];\r\n    if (!(typeof tabTeamId === \"string\")) throw new Error(\"properties[TabTeamId] is not of type string\");\r\n\r\n    let tabChannelId = properties[TabChannelId];\r\n    if (!(typeof tabChannelId === \"string\")) throw new Error(\"properties[TabChannelId] is not of type string\");\r\n\r\n    var url = baseUriEndpoint + \"/teams/\" + encodeURIComponent(tabTeamId) + \"/channels/\" + encodeURIComponent(tabChannelId) + \"/tabs?$select=id,displayName,webUrl\";\r\n    ExecuteRequest(url, null, \"GET\", function (responseText) {\r\n        if (typeof cb === 'function')\r\n            cb(responseText);\r\n    });\r\n}","import '@k2oss/k2-broker-core';\r\nimport './index.ts';\r\n\r\nfunction mock(name: string, value: any) {\r\n    global[name] = value;\r\n}\r\n\r\n// This value is obfuscated on purpose. Replace with a valid OAuth token to run\r\nlet OAuthToken = \"\";\r\n\r\nlet schema = null;\r\nmock('postSchema', function (result: any) {\r\n    schema = result;\r\n    console.log(\"postSchema:\");\r\n    console.log(schema);\r\n});\r\n\r\nlet result: any = null;\r\nfunction pr(r: any) {\r\n    result = r;\r\n   // console.log(\"postResult:\")\r\n   // console.log(JSON.stringify(result));\r\n}\r\n\r\nmock('postResult', pr);\r\nlet xhr: { [key: string]: any } = null;\r\nclass XHR {\r\n    public onreadystatechange: () => void;\r\n    public readyState: number;\r\n    public status: number;\r\n    public responseText: string;\r\n    public withCredentials: boolean\r\n\r\n    private recorder: { [key: string]: any };\r\n\r\n    constructor() {\r\n        xhr = this.recorder = {};\r\n        this.recorder.headers = {};\r\n    }\r\n\r\n    open(method: string, url: string) {\r\n        this.recorder.opened = { method, url };\r\n    }\r\n\r\n    setRequestHeader(key: string, value: string) {\r\n        this.recorder.headers[key] = value;\r\n       // console.log(\"setRequestHeader: \" + key + \"=\" + value);\r\n    }\r\n\r\n    send(payload) {\r\n        const request = require('request')\r\n        if (this.withCredentials) {\r\n            this.setRequestHeader(\"Authorization\", \"Bearer \" + OAuthToken);\r\n        }\r\n\r\n        const options = {\r\n            method: this.recorder.opened.method,\r\n            url: this.recorder.opened.url,\r\n            headers: this.recorder.headers,\r\n            body: payload,\r\n            strictSSL: false\r\n        };\r\n       // console.log(\"URL: \" + options.method + \" \" + options.url);\r\n       // console.log(\"BODY: \" + options.body);\r\n        let promise = new Promise((resolve, reject) => {\r\n            try {\r\n                request(options, (error, res, body) => {\r\n                    if (error) {\r\n                        console.error(\"error inside request:\" + error)\r\n                        return\r\n                    }\r\n                    this.responseText = body;\r\n                    this.readyState = 4;\r\n                    this.status = res.statusCode;\r\n                    this.onreadystatechange();\r\n                    resolve(body);\r\n                    delete this.responseText;\r\n                });\r\n            }\r\n            catch (err) {\r\n                console.log(\"error ouside request \" + err);\r\n                reject()\r\n            }\r\n        }).catch((errr) => {\r\n            console.log(\"Promise error:\" + errr);\r\n        });\r\n    }\r\n}\r\n\r\nmock('XMLHttpRequest', XHR);\r\n\r\nonexecute({\r\n    objectName: 'channel',\r\n    methodName: 'getMessages',\r\n    properties: {\"teamId\":\"26be3fc7-57f3-4978-aab4-9ed41c84e271\", \"id\":\"19:ee6a2aa128574128896abdb0c152b24f@thread.tacv2\"},\r\n    parameters: {},\r\n    configuration: {},\r\n    schema: {}\r\n});\r\n\r\n"],"names":["metadata","systemName","displayName","description","baseUriEndpoint","baseUriEndpointBeta","CreateTeam","parameters","properties","cb","data","JSON","stringify","ExecuteRequest","responseText","GetUser","teamUserPrincipalName","Error","encodeURIComponent","AddGroupOwner","teamId","AddGroupMembers","url","requestType","xhr","XMLHttpRequest","onreadystatechange","console","log","status","readyState","obj","parse","error","code","message","postResult","startswith","open","toUpperCase","withCredentials","setRequestHeader","send","CreateAndReturnTeamObject","CreateAndReturnChannelObject","GetCleanedMessage","messageObject","body","content","indexOf","tempMessage","card","attachments","cardObject","undefined","forEach","b","type","columns","c","items","i","startTag","size","boldStartTag","weight","boldEndTag","endTag","text","replace","onexecuteTabCreate","methodName","prepareDataAndCreateTab","getRequestBody","requestBody","configuration","tabTeamId","tabChannelId","CreateTab","a","id","webUrl","entityId","contentUrl","websiteUrl","removeUrl","tabType","mock","name","value","global","ondescribe","postSchema","objects","methods","inputs","requiredInputs","outputs","onexecute","objectName","GetGroupDetailsById","createdDateTime","mail","mailEnabled","mailNickname","GetTeamDetailsByID","isArchived","onexecuteTeamGet","CreateGroup","onexecuteTeamCreate","d","e","onexecuteTeamAdd","UpdateTeam","onexecuteTeamUpdate","teamDisplayNameStartsWith","component","GetTeams","map","x","resourceProvisioningOptions","onexecuteTeamList","ArchiveTeam","onexecuteTeamArchive","UnarchiveTeam","onexecuteTeamUnarchive","userPrincipalName","onexecuteTeamAddMember","teamUserId","RemoveGroupMembers","onexecuteTeamRemoveMember","CloneTeam","onexecuteTeamClone","onexecuteTeamAddOwner","teamArchiveOperationUrl","CheckArchivalStatus","operationType","lastActionDateTime","attemptsCount","targetResourceId","targetResourceLocation","onexecuteTeamCheckStatus","onexecuteTeam","channelTeamId","channelId","GetChannel","email","onexecuteChannelGet","GetChannelList","onexecuteChannelList","CreateChannel","onexecuteChannelCreate","DeleteChannel","onexecuteChannelDelete","UpdateChannel","onexecuteChannelUpdate","channelUserPrincipalName","GetChannelUser","AddChannelMembers","onexecuteChannelAddMember","toString","GetUsers","u","importance","mentions","payload","users","matches","match","length","user","filter","item","mentionObj","push","GetMentions","SendMessage","onexecuteSendMessage","channelMessageId","ReplyMessage","onexecuteReplyMessage","SendAdaptiveCard","onexecuteSendAdaptiveCard","messages","from","GetChannelMessages","date","onexecuteGetChannelMessages","GetChannelDrive","parentReference","driveId","onexecuteGetChannelDrive","GetChannelMembers","userId","onexecuteGetChannelMembers","channelUserId","RemoveChannelMember","onexecuteRemoveChannelMember","onexecuteChannel","tabId","GetTabInformation","teamsApp","externalId","distributionMethod","sortOrderIndex","onexecuteTabGet","UpdateTab","onexecuteTabUpdate","GetTabList","onexecuteTabList","DeleteTab","onexecuteTabDelete","onexecuteTab","appTeamId","GetInstalledAppList","teamsAppDefinition","version","teamsAppId","onexecuteInstalledAppList","onexecuteApp","tokenLifetime","policyDisplayName","isOrgDefault","TokenUpdateSuccess","SetTokenPolicy","onexecutePolicySet","onexecuteToken","GetDriveRootChildren","onexecuteGetDriveRootChildren","onexecuteDrive","relativePath","GetSiteLists","onexecuteGetSiteLists","onexecuteSite","schema","result","r","constructor","this","recorder","headers","method","opened","key","request","require","options","strictSSL","Promise","resolve","reject","res","statusCode","err","catch","errr"],"mappings":"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"}