!function(){metadata={systemName:"MSTeamsJSSP",displayName:"Microsoft Teams Connector",description:"A connector for Microsoft Teams"};const e="https://graph.microsoft.com/v1.0",t="https://graph.microsoft.com/beta";function i(t,i,s){var a=JSON.stringify({});o(e+"/groups/"+i.id+"/team",a,"PUT",(function(e){"function"==typeof s&&s(e)}))}function s(t,i,s){let a=i.userPrincipalName;if("string"!=typeof a)throw new Error("properties[TeamUserPrincipalName] is not of type string");o(e+"/users/"+encodeURIComponent(a),null,"GET",(function(e){"function"==typeof s&&s(e)}))}function a(t,i,s){var a=JSON.stringify({"@odata.id":e+"/users/"+i.userId});let n=i.id;if("string"!=typeof n)throw new Error("properties[TeamId] is not of type string");o(e+"/groups/"+encodeURIComponent(n)+"/owners/$ref",a,"POST",(function(e){"function"==typeof s&&s(e)}))}function n(t,i,s){var a=JSON.stringify({"@odata.id":e+"/directoryObjects/"+i.userId});let n=i.id;if("string"!=typeof n)throw new Error("properties[TeamId] is not of type string");o(e+"/groups/"+encodeURIComponent(n)+"/members/$ref",a,"POST",(function(e){"function"==typeof s&&s(e)}))}function o(e,t,i,s){var a=new XMLHttpRequest;a.onreadystatechange=function(){if(4===a.readyState)if(201==a.status){var e=JSON.parse(a.responseText);"function"==typeof s&&s(e)}else if(204==a.status)"function"==typeof s&&s(a.responseText);else if(200==a.status){e=JSON.parse(a.responseText);"function"==typeof s&&s(e)}else if(202==a.status)"function"==typeof s&&s(null);else{if(400==a.status){e=JSON.parse(a.responseText);throw new Error(e.error.code+": "+e.error.message)}if(404!=a.status){postResult({});e=JSON.parse(a.responseText);throw new Error(e.error.code+": "+e.error.message)}if("No Team found with Group id"!=(e=JSON.parse(a.responseText)).error.message.startswith)throw new Error(e.error.code+": "+e.error.message)}},console.log("MSTeamsConnector ExecuteRequest: "+e),a.open(i.toUpperCase(),e),a.withCredentials=!0,a.setRequestHeader("Accept","application/json"),"PUT"!=i.toUpperCase()&&"POST"!=i.toUpperCase()&&"PATCH"!=i.toUpperCase()||a.setRequestHeader("Content-Type","application/json"),a.send(t)}function r(e,t){postResult({id:t.id,displayName:t.displayName,creationDate:t.creationDate,description:t.description,email:t.email,mailEnabled:t.mailEnabled,mailNickname:t.mailNickname,weburl:t.weburl,archiveStatus:t.archiveStatus,isSuccessful:t.isSuccessful})}function p(e,t){postResult({id:t.id,displayName:t.displayName,description:t.description,email:t.email,weburl:t.weburl,isSuccessful:t.isSuccessful})}function l(e){var t=e.body.content;if(t.indexOf('<attachment id="74d20c7f34aa4a7fb74e2b30004247c5"></attachment>')>-1){var i="",s=e.attachments[0].content,a=JSON.parse(s);null!=a.body?a.body.forEach(e=>{"ColumnSet"==e.type&&e.columns.forEach(e=>{e.items.forEach(e=>{if("TextBlock"==e.type){var t=null!=e.size&&"large"==e.size?"<h3>":"<span>",s=null!=e.weight&&"bolder"==e.weight?"<b>":"",a="<b>"==s?"</b>":"",n="<h3>"==t?"</h3>":"</span>";i+=`<div class='teams-message-row'>${t}${s}${e.text}${a}${n}</div>`}})})}):t=a.text,t=t.replace('<attachment id="74d20c7f34aa4a7fb74e2b30004247c5"></attachment>',i)}return t=t.replace("<at","<b").replace("</at>","</b>")}function d(e,t,i){switch(e){case"createWordTab":c(t,i,m("Word",i));break;case"createExcelTab":c(t,i,m("Excel",i));break;case"createPowerPointTab":c(t,i,m("PowerPoint",i));break;case"createPdfTab":c(t,i,m("PDF",i));break;case"createOneNoteTab":c(t,i,m("OneNote",i));break;case"createPlannerTab":c(t,i,m("Planner",i));break;case"createSharePointTab":c(t,i,m("SharePoint",i));break;case"createMsFormsTab":c(t,i,m("MicrosoftForms",i));break;case"createStreamTab":c(t,i,m("MicrosoftStream",i));break;case"createWebsiteTab":c(t,i,m("Website",i));break;case"createWikiTab":c(t,i,m("Wiki",i));break;case"createPowerBiTab":c(t,i,m("PowerBI",i));break;case"createDocumentLibraryTab":c(t,i,m("DocumentLibrary",i));break;case"createCustomTab":c(t,i,m("Custom",i));break;default:throw new Error("The object "+e+" is not supported.")}}function c(t,i,s){s.configuration={entityId:i.configEntityId,contentUrl:i.configContentUrl,removeUrl:i.configRemoveUrl,websiteUrl:i.configWebsiteUrl},function(t,i,s,a){let n=i.teamId;if("string"!=typeof n)throw new Error("properties[TabTeamId] is not of type string");let r=i.channelId;if("string"!=typeof r)throw new Error("properties[TabChannelId] is not of type string");o(e+"/teams/"+encodeURIComponent(n)+"/channels/"+encodeURIComponent(r)+"/tabs",s,"POST",(function(e){"function"==typeof a&&a(e)}))}(0,i,JSON.stringify(s),(function(e){postResult({id:e.id,displayName:e.displayName,weburl:e.webUrl,configEntityId:e.configuration.entityId,configContentUrl:e.configuration.contentUrl,configWebsiteUrl:e.configuration.websiteUrl,configRemoveUrl:e.configuration.removeUrl,isSuccessful:!0})}))}function m(e,t){var i;switch(e){case"Word":i={displayName:t.displayName,"teamsApp@odata.bind":"https://graph.microsoft.com/v1.0/appCatalogs/teamsApps/com.microsoft.teamspace.tab.file.staticviewer.word"};break;case"Excel":i={displayName:t.displayName,"teamsApp@odata.bind":"https://graph.microsoft.com/v1.0/appCatalogs/teamsApps/com.microsoft.teamspace.tab.file.staticviewer.excel"};break;case"Powerpoint":i={displayName:t.displayName,"teamsApp@odata.bind":"https://graph.microsoft.com/v1.0/appCatalogs/teamsApps/com.microsoft.teamspace.tab.file.staticviewer.powerpoint"};break;case"PDF":i={displayName:t.displayName,"teamsApp@odata.bind":"https://graph.microsoft.com/v1.0/appCatalogs/teamsApps/com.microsoft.teamspace.tab.file.staticviewer.pdf"};break;case"OneNote":i={displayName:t.displayName,"teamsApp@odata.bind":"https://graph.microsoft.com/v1.0/appCatalogs/teamsApps/0d820ecd-def2-4297-adad-78056cde7c78"};break;case"Planner":i={displayName:t.displayName,"teamsApp@odata.bind":"https://graph.microsoft.com/v1.0/appCatalogs/teamsApps/com.microsoft.teamspace.tab.planner"};break;case"SharePoint":i={displayName:t.displayName,"teamsApp@odata.bind":"https://graph.microsoft.com/v1.0/appCatalogs/teamsApps/2a527703-1f6f-4559-a332-d8a7d288cd88"};break;case"MicrosoftForms":i={displayName:t.displayName,"teamsApp@odata.bind":"https://graph.microsoft.com/v1.0/appCatalogs/teamsApps/81fef3a6-72aa-4648-a763-de824aeafb7d"};break;case"MicrosoftStream":i={displayName:t.displayName,"teamsApp@odata.bind":"https://graph.microsoft.com/v1.0/appCatalogs/teamsApps/com.microsoftstream.embed.skypeteamstab"};break;case"Website":i={displayName:t.displayName,"teamsApp@odata.bind":"https://graph.microsoft.com/v1.0/appCatalogs/teamsApps/com.microsoft.teamspace.tab.web"};break;case"Wiki":i={displayName:t.displayName,"teamsApp@odata.bind":"https://graph.microsoft.com/v1.0/appCatalogs/teamsApps/com.microsoft.teamspace.tab.wiki"};break;case"PowerBI":i={displayName:t.displayName,"teamsApp@odata.bind":"https://graph.microsoft.com/v1.0/appCatalogs/teamsApps/com.microsoft.teamspace.tab.powerbi"};break;case"DocumentLibrary":i={displayName:t.displayName,"teamsApp@odata.bind":"https://graph.microsoft.com/v1.0/appCatalogs/teamsApps/com.microsoft.teamspace.tab.files.sharepoint"};break;case"Custom":i={displayName:t.displayName,"teamsApp@odata.bind":"https://graph.microsoft.com/v1.0/appCatalogs/teamsApps/"+t.teamsAppAppId};break;default:throw new Error("Tab Type is not supported or app is not installed!")}return i}function u(e,t){global[e]=t}ondescribe=function(){postSchema({objects:{team:{displayName:"Team",description:"Team",properties:{id:{displayName:"Team Id",type:"string"},weburl:{displayName:"Web Url",type:"string"},displayName:{displayName:"Display Name",type:"string"},creationDate:{displayName:"Created On",type:"string"},description:{displayName:"Description",type:"string"},email:{displayName:"Email",type:"string"},mailEnabled:{displayName:"Mail Enabled",type:"boolean"},mailNickname:{displayName:"Mail Nickname",type:"string"},archiveStatus:{displayName:"Archive Status",type:"string"},operationId:{displayName:"Operation Id",type:"string"},operationType:{displayName:"Operation Type",type:"string"},lastActionDate:{displayName:"Last Action Date",type:"string"},attemptsCount:{displayName:"Attempts Count",type:"string"},targetResourceId:{displayName:"Target Resource Id",type:"string"},targetResourceLocation:{displayName:"Target Resource Location",type:"string"},archiveError:{displayName:"Error",type:"string"},userPrincipalName:{displayName:"User Principal Name",type:"string"},resourceProvisioningOptions:{displayName:"Resource Provisioning Options",type:"string"},isArchived:{displayName:"Is Archived",type:"boolean"},isSuccessful:{displayName:"Is Successful",type:"boolean"},requestStatusUrl:{displayName:"Request Status Url",type:"boolean"},msAllowCreateUpdateChannels:{displayName:"Allow create/update channels to members",type:"boolean"},msAllowDeleteChannels:{displayName:"Allow delete channels to members",type:"boolean"},msAllowAddRemoveApps:{displayName:"Allow add/remove apps to members",type:"boolean"},msAllowCreateUpdateRemoveTabs:{displayName:"Allow create/update/remove tabs to members",type:"boolean"},msAllowCreateUpdateRemoveConnectors:{displayName:"Allow create/update/remove connectors to members",type:"boolean"},gsAllowCreateUpdateChannels:{displayName:"Allow create/update channels to guests",type:"boolean"},gsAllowDeleteChannels:{displayName:"Allow delete channels to guests",type:"boolean"},msgsAllowUserEditMessages:{displayName:"Allow user to edit messages",type:"boolean"},msgsAllowUserDeleteMessages:{displayName:"Allow user to delete messages",type:"boolean"},msgsAllowOwnerDeleteMessages:{displayName:"Allow owner to delete messages",type:"boolean"},msgsAllowTeamMentions:{displayName:"Allow team mentions",type:"boolean"},msgsAllowChannelMentions:{displayName:"Allow channel mentions",type:"boolean"},fsAllowGiphy:{displayName:"Allow Giphy",type:"boolean"},fsAllowStickersAndMemes:{displayName:"Allow stickers and memes",type:"boolean"},fsAllowCustomMemes:{displayName:"Allow custom memes",type:"boolean"}},methods:{get:{displayName:"Get",description:"Retrieves the details of a Team",type:"read",inputs:["id"],requiredInputs:["id"],outputs:["id","displayName","creationDate","description","email","mailEnabled","mailNickname","weburl","archiveStatus","isSuccessful"]},create:{displayName:"Create",description:"Creates a Team",type:"create",inputs:["displayName","description","mailEnabled","mailNickname","userPrincipalName"],requiredInputs:["displayName","mailEnabled","mailNickname"],outputs:["id","displayName","creationDate","description","email","mailEnabled","mailNickname","weburl","isSuccessful"]},archive:{displayName:"Archive",description:"Archives a Team (makes it read-only)",type:"execute",inputs:["id"],requiredInputs:["id"],outputs:["id","requestStatusUrl","isSuccessful"]},unarchive:{displayName:"Unarchive",description:"Unarchives a Team",type:"execute",inputs:["id"],requiredInputs:["id"],outputs:["id","requestStatusUrl","isSuccessful"]},addMember:{displayName:"Add Member",description:"Adds a member to a Team",type:"create",inputs:["id","userPrincipalName"],requiredInputs:["id","userPrincipalName"],outputs:["isSuccessful"]},removeMember:{displayName:"Remove Member",description:"Removes a member from a Team",type:"delete",inputs:["id","userPrincipalName"],requiredInputs:["id","userPrincipalName"],outputs:["isSuccessful"]},update:{displayName:"Update",description:"Updates a Team's settings",type:"update",inputs:["id","msAllowCreateUpdateChannels","msAllowDeleteChannels","msAllowAddRemoveApps","msAllowCreateUpdateRemoveTabs","msAllowCreateUpdateRemoveConnectors","gsAllowCreateUpdateChannels","gsAllowDeleteChannels","msgsAllowUserEditMessages","msgsAllowUserDeleteMessages","msgsAllowUserDeleteMessages","msgsAllowTeamMentions","msgsAllowChannelMentions","fsAllowGiphy","fsAllowStickersAndMemes","fsAllowCustomMemes"],requiredInputs:["id"],outputs:["isSuccessful"]},clone:{displayName:"Copy/Clone",description:"Makes a copy of an existing Team",type:"create",inputs:["id","displayName","description","mailNickname"],requiredInputs:["id","displayName","description","mailNickname"],outputs:["id","requestStatusUrl","isSuccessful"]},addOwner:{displayName:"Add Owner",description:"Adds an Owner to a Team",type:"execute",inputs:["id","userPrincipalName"],requiredInputs:["id","userPrincipalName"],outputs:["isSuccessful"]},list:{displayName:"List",description:"Lists all Teams and groups without Teams",type:"list",parameters:{displayNameStartsWith:{displayName:"Display Name Starts With",type:"string"}},outputs:["id","displayName","resourceProvisioningOptions"]},myTeamsList:{displayName:"List My Teams",description:"Lists all Teams you belong to",type:"list",outputs:["id","displayName","description","isArchived"]}}},channel:{displayName:"Channel",description:"Channel",properties:{id:{displayName:"Channel Id",description:"Channel Id",type:"string"},displayName:{displayName:"Display Name",description:"Display Name",type:"string"},description:{displayName:"Description",description:"Description",type:"string"},email:{displayName:"Email",description:"Email",type:"string"},weburl:{displayName:"Web URL",description:"Web URL",type:"string"},isSuccessful:{displayName:"Is Successful",description:"Is Successful",type:"string"},teamId:{displayName:"Team Id",description:"Team Id",type:"string"},messageSubject:{displayName:"Subject",description:"Message Subject",type:"string"},messageId:{displayName:"Message Id",description:"Message Id",type:"string"},messageBody:{displayName:"Body",description:"Message Body",type:"string"},messageIsImportant:{displayName:"Is Important",description:"Message Importance (Normal/High)",type:"boolean"},membershipType:{displayName:"Membership Type",description:"Type of Channel",type:"string"},userPrincipalName:{displayName:"User Principal Name",description:"Principal Name of User",type:"string"},messageDate:{displayName:"Message Date",description:"Message Date",type:"dateTime"},messageUser:{displayName:"Message User",description:"Message User",type:"string"},channelDriveId:{displayName:"Drive ID",description:"Drive ID",type:"string"},channelDriveUrl:{displayName:"Drive URL",description:"Drive URL",type:"string"}},methods:{get:{displayName:"Get",description:"Retrieves the details of a Channel",type:"read",inputs:["teamId","id"],requiredInputs:["id","teamId"],outputs:["id","displayName","description","email","weburl","isSuccessful"]},list:{displayName:"List",description:"List the channels in a Team",type:"list",inputs:["teamId"],requiredInputs:["teamId"],outputs:["id","displayName","description","email"]},create:{displayName:"Create",description:"Creates a new Channel",type:"create",inputs:["teamId","displayName","membershipType","description"],requiredInputs:["teamId","displayName","membershipType"],outputs:["id","displayName","description","email","weburl","isSuccessful"]},delete:{displayName:"Delete",description:"Deletes a Channel",type:"delete",inputs:["id","teamId"],requiredInputs:["id","teamId"],outputs:["isSuccessful"]},update:{displayName:"Update",description:"Updates a Channel",type:"update",inputs:["teamId","id","displayName","description"],requiredInputs:["id","teamId","displayName","description"],outputs:["isSuccessful"]},addMember:{displayName:"Add Member",description:"Adds a member to a Channel",type:"create",inputs:["teamId","id","userPrincipalName"],requiredInputs:["teamId","id","userPrincipalName"],outputs:["isSuccessful"]},sendMessage:{displayName:"Send Message",description:"Sends a Message to a Channel",type:"create",inputs:["teamId","id","messageSubject","messageBody","messageIsImportant"],requiredInputs:["teamId","id","messageBody"],outputs:["isSuccessful","messageId"]},replyMessage:{displayName:"Reply to a Message",description:"Reply to a Message in a Channel",type:"create",inputs:["teamId","id","messageId","messageBody"],requiredInputs:["teamId","id","messageId","messageBody"],outputs:["isSuccessful"]},sendAdaptiveCard:{displayName:"Send Adaptive Card",description:"Sends a Message to a Channel",type:"create",inputs:["teamId","id","messageBody"],requiredInputs:["teamId","id","messageBody"],outputs:["isSuccessful","messageId"]},getMessages:{displayName:"Get Messages in a Channel",description:"Get Messages in a Channel",type:"list",inputs:["teamId","id"],requiredInputs:["teamId","id"],outputs:["messageId","messageBody","messageDate","messageUser"]},getDrive:{displayName:"Get Channel Drive",description:"Get Channel Drive",type:"read",inputs:["teamId","id"],requiredInputs:["teamId","id"],outputs:["channelDriveId","channelDriveUrl"]}}},tab:{displayName:"Tab",description:"Tab",properties:{id:{displayName:"Tab Id",description:"Tab Id",type:"string"},displayName:{displayName:"Display Name",description:"Display Name",type:"string"},configEntityId:{displayName:"Entity Id",description:"Entity Id",type:"string"},configContentUrl:{displayName:"Content URL",description:"Content URL",type:"string"},configWebsiteUrl:{displayName:"Website URL",description:"Website URL",type:"string"},configRemoveUrl:{displayName:"Remove URL",description:"Remove URL",type:"string"},teamsAppAppId:{displayName:"App Id",description:"App Id",type:"string"},teamsAppExternalId:{displayName:"External Id",description:"External Id",type:"string"},teamsAppAppDisplayName:{displayName:"App Display Name",description:"App Display Name",type:"string"},teamsAppDistMethod:{displayName:"Distribution Method",description:"Distribution Method",type:"string"},sortOrderIndex:{displayName:"Sort Order Index",description:"Sort Order Index",type:"string"},weburl:{displayName:"Web URL",description:"Web URL",type:"string"},isSuccessful:{displayName:"Is Successful",description:"Is Successful",type:"boolean"},teamId:{displayName:"Team Id",description:"Team Id",type:"string"},channelId:{displayName:"Channel Id",description:"Channel Id",type:"string"}},methods:{get:{displayName:"Get",description:"Get the details of a tab.",type:"read",inputs:["id","teamId","channelId"],requiredInputs:["id","teamId","channelId"],outputs:["id","displayName","configEntityId","configContentUrl","configWebsiteUrl","configRemoveUrl","teamsAppAppId","teamsAppExternalId","teamsAppAppDisplayName","teamsAppDistMethod","sortOrderIndex","weburl"]},list:{displayName:"List",description:"List tabs",type:"list",inputs:["teamId","channelId"],requiredInputs:["teamId","channelId"],outputs:["id","displayName","weburl"]},createWordTab:{displayName:"Create Word tab",type:"create",inputs:["teamId","channelId","displayName","configEntityId","configContentUrl","configWebsiteUrl","configRemoveUrl"],requiredInputs:["teamId","channelId","displayName"],outputs:["id","displayName","weburl","configEntityId","configContentUrl","configWebsiteUrl","configRemoveUrl","isSuccessful"]},createExcelTab:{displayName:"Create Excel tab",type:"create",inputs:["teamId","channelId","displayName","configEntityId","configContentUrl","configWebsiteUrl","configRemoveUrl"],requiredInputs:["teamId","channelId","displayName"],outputs:["id","displayName","weburl","configEntityId","configContentUrl","configWebsiteUrl","configRemoveUrl","isSuccessful"]},createPowerPointTab:{displayName:"Create PowerPoint tab",type:"create",inputs:["teamId","channelId","displayName","configEntityId","configContentUrl","configWebsiteUrl","configRemoveUrl"],requiredInputs:["teamId","channelId","displayName"],outputs:["id","displayName","weburl","configEntityId","configContentUrl","configWebsiteUrl","configRemoveUrl","isSuccessful"]},createPdfTab:{displayName:"Create PDF tab",type:"create",inputs:["teamId","channelId","displayName","configEntityId","configContentUrl","configWebsiteUrl","configRemoveUrl"],requiredInputs:["teamId","channelId","displayName"],outputs:["id","displayName","weburl","configEntityId","configContentUrl","configWebsiteUrl","configRemoveUrl","isSuccessful"]},createOneNoteTab:{displayName:"Create OneNote tab",type:"create",inputs:["teamId","channelId","displayName","configEntityId","configContentUrl","configWebsiteUrl","configRemoveUrl"],requiredInputs:["teamId","channelId","displayName"],outputs:["id","displayName","weburl","configEntityId","configContentUrl","configWebsiteUrl","configRemoveUrl","isSuccessful"]},createPlannerTab:{displayName:"Create Planner tab",type:"create",inputs:["teamId","channelId","displayName","configEntityId","configContentUrl","configWebsiteUrl","configRemoveUrl"],requiredInputs:["teamId","channelId","displayName"],outputs:["id","displayName","weburl","configEntityId","configContentUrl","configWebsiteUrl","configRemoveUrl","isSuccessful"]},createSharePointTab:{displayName:"Create SharePoint tab",type:"create",inputs:["teamId","channelId","displayName","configEntityId","configContentUrl","configWebsiteUrl","configRemoveUrl"],requiredInputs:["teamId","channelId","displayName"],outputs:["id","displayName","weburl","configEntityId","configContentUrl","configWebsiteUrl","configRemoveUrl","isSuccessful"]},createMsFormsTab:{displayName:"Create Forms tab",type:"create",inputs:["teamId","channelId","displayName","configEntityId","configContentUrl","configWebsiteUrl","configRemoveUrl"],requiredInputs:["teamId","channelId","displayName"],outputs:["id","displayName","weburl","configEntityId","configContentUrl","configWebsiteUrl","configRemoveUrl","isSuccessful"]},createStreamTab:{displayName:"Create Stream tab",type:"create",inputs:["teamId","channelId","displayName","configEntityId","configContentUrl","configWebsiteUrl","configRemoveUrl"],requiredInputs:["teamId","channelId","displayName"],outputs:["id","displayName","weburl","configEntityId","configContentUrl","configWebsiteUrl","configRemoveUrl","isSuccessful"]},createWebsiteTab:{displayName:"Create Website tab",type:"create",inputs:["teamId","channelId","displayName","configEntityId","configContentUrl","configWebsiteUrl","configRemoveUrl"],requiredInputs:["teamId","channelId","displayName"],outputs:["id","displayName","weburl","configEntityId","configContentUrl","configWebsiteUrl","configRemoveUrl","isSuccessful"]},createWikiTab:{displayName:"Create Wiki tab",type:"create",inputs:["teamId","channelId","displayName","configEntityId","configContentUrl","configWebsiteUrl","configRemoveUrl"],requiredInputs:["teamId","channelId","displayName"],outputs:["id","displayName","weburl","configEntityId","configContentUrl","configWebsiteUrl","configRemoveUrl","isSuccessful"]},createPowerBiTab:{displayName:"Create PowerBI tab",type:"create",inputs:["teamId","channelId","displayName","configEntityId","configContentUrl","configWebsiteUrl","configRemoveUrl"],requiredInputs:["teamId","channelId","displayName"],outputs:["id","displayName","weburl","configEntityId","configContentUrl","configWebsiteUrl","configRemoveUrl","isSuccessful"]},createDocumentLibraryTab:{displayName:"Create Document tab",type:"create",inputs:["teamId","channelId","displayName","configEntityId","configContentUrl","configWebsiteUrl","configRemoveUrl"],requiredInputs:["teamId","channelId","displayName"],outputs:["id","displayName","weburl","configEntityId","configContentUrl","configWebsiteUrl","configRemoveUrl","isSuccessful"]},createCustomTab:{displayName:"Create custom tab",type:"create",inputs:["teamId","channelId","teamsAppAppId","displayName","configEntityId","configContentUrl","configWebsiteUrl","configRemoveUrl"],requiredInputs:["teamId","channelId","teamsAppAppId","displayName"],outputs:["id","displayName","weburl","configEntityId","configContentUrl","configWebsiteUrl","configRemoveUrl","isSuccessful"]},delete:{displayName:"Delete tab",type:"delete",inputs:["teamId","channelId","id"],requiredInputs:["teamId","channelId","id"],outputs:["isSuccessful"]},update:{displayName:"Update tab",type:"update",inputs:["teamId","channelId","id","displayName","configContentUrl","configWebsiteUrl","configRemoveUrl"],requiredInputs:["teamId","channelId","id"],outputs:["isSuccessful"]}}},app:{displayName:"App",description:"App",properties:{id:{displayName:"App Id",description:"App Id",type:"string"},teamId:{displayName:"Team Id",description:"Team Id",type:"string"},displayName:{displayName:"App Display Name",description:"App Display Name",type:"string"},version:{displayName:"version",description:"version",type:"string"},teamsAppDefinitionId:{displayName:"Teams App Definition Id",description:"Teams App Definition Id",type:"string"},teamsAppId:{displayName:"Teams App Id",description:"Teams App Id",type:"string"}},methods:{list:{displayName:"List installed apps",type:"list",inputs:["teamId"],requiredInputs:["teamId"],outputs:["id","displayName","version","teamsAppDefinitionId","teamsAppId"]}}},token:{displayName:"Token",description:"Token",properties:{tokenLifeTime:{displayName:"Token Lifetime (hh:mm:ss)",description:"Token Lifetime (hh:mm:ss)",type:"string"},displayName:{displayName:"Policy Display Name",description:"Policy Display Name",type:"string"},isOrganizationDefault:{displayName:"Is Organization Default",description:"Is Organization Default",type:"boolean"},updateSuccess:{displayName:"Policy Update Success",description:"Policy Update Success",type:"boolean"}},methods:{setToken:{displayName:"Set Token Policy",type:"execute",inputs:["tokenLifeTime","displayName","isOrganizationDefault"],requiredInputs:["tokenLifeTime","displayName"],outputs:["updateSuccess"]}}},drive:{displayName:"Drive",description:"Drive",properties:{driveId:{displayName:"Drive ID",description:"Drive ID",type:"string"},drivePath:{displayName:"Relative Path",description:"Relative Path",type:"string"},driveChildDownloadUrl:{displayName:"Download URL",description:"Download URL",type:"string"},driveChildFileCreatedDate:{displayName:"Created Date",description:"Created Date",type:"dateTime"},driveChildFileCreatedBy:{displayName:"Created By",description:"Created By",type:"string"},driveChildFileName:{displayName:"File Name",description:"File Name",type:"string"},driveChildFileType:{displayName:"File Type",description:"File Type",type:"string"},driveChildId:{displayName:"File ID",description:"File ID",type:"string"},driveChildWebUrl:{displayName:"Web URL",description:"Web URL",type:"string"}},methods:{driveGetChildren:{displayName:"Get Drive Children",type:"list",inputs:["driveId","drivePath"],requiredInputs:["driveId","drivePath"],outputs:["driveChildId","driveChildFileName","driveChildDownloadUrl","driveChildWebUrl","driveChildFileType","driveChildFileCreatedDate","driveChildFileCreatedBy"]}}}}})},onexecute=function({objectName:c,methodName:m,parameters:u,properties:f}){switch(c){case"team":!function(t,p,l){null==l&&null==p||(null==l&&null!==p?p.isSuccessful=!0:l.isSuccessful=!0);switch(t){case"get":!function(t,i){i.isSuccessful=!0,function(t,i,s){let a=i.id;if("string"!=typeof a)throw new Error("properties[TeamId] is not of type string");o(e+"/groups/"+encodeURIComponent(a),null,"GET",(function(e){"function"==typeof s&&s(e)}))}(0,i,(function(s){i.displayName=s.displayName,i.creationDate=s.createdDateTime,i.description=s.description,i.email=s.mail,i.mailEnabled=s.mailEnabled,i.mailNickname=s.mailNickname,function(t,i,s){let a=i.id;if("string"!=typeof a)throw new Error("properties[TeamId] is not of type string");o(e+"/teams/"+encodeURIComponent(a),null,"GET",(function(e){"function"==typeof s&&s(e)}))}(0,i,(function(e){i.weburl=e.webUrl,i.archiveStatus=e.isArchived,r(t,i)}))}))}(p,l);break;case"create":!function(t,s){s.isSuccessful=!0,function(t,i,s){var a=JSON.stringify({description:i.description,displayName:i.displayName,groupTypes:["Unified"],mailEnabled:i.mailEnabled,mailNickname:i.mailNickname,visibility:"Private",securityEnabled:!1});o(e+"/groups/",a,"POST",(function(e){"function"==typeof s&&s(e)}))}(0,s,(function(e){s.id=e.id,s.creationDate=e.createdDateTime,s.description=e.description,s.displayName=e.displayName,s.email=e.mail,s.mailEnabled=e.mailEnabled,s.mailNickname=e.mailNickname,i(t,s,(function(e){s.weburl=e.webUrl,r(t,s)}))}))}(p,l);break;case"add":!function(e,t){i(e,t,(function(i){t.weburl=i.webUrl,s(e,t,(function(i){t.userId=i.id,a(e,t,(function(i){n(e,t,(function(i){r(e,t)}))}))}))}))}(p,l);break;case"update":!function(t,i){!function(t,i,s){var a=JSON.stringify({memberSettings:{allowCreateUpdateChannels:i.msAllowCreateUpdateChannels,allowDeleteChannels:i.msAllowDeleteChannels,allowAddRemoveApps:i.msAllowAddRemoveApps,allowCreateUpdateRemoveTabs:i.msAllowCreateUpdateRemoveTabs,allowCreateUpdateRemoveConnectors:i.msAllowCreateUpdateRemoveConnectors},guestSettings:{allowCreateUpdateChannels:i.gsAllowCreateUpdateChannels,allowDeleteChannels:i.gsAllowDeleteChannels},messagingSettings:{allowUserEditMessages:i.msgsAllowUserEditMessages,allowUserDeleteMessages:i.msgsAllowUserDeleteMessages,allowOwnerDeleteMessages:i.msgsAllowUserDeleteMessages,allowTeamMentions:i.msgsAllowTeamMentions,allowChannelMentions:i.msgsAllowChannelMentions},funSettings:{allowGiphy:i.fsAllowGiphy,allowStickersAndMemes:i.fsAllowStickersAndMemes,allowCustomMemes:i.fsAllowCustomMemes}});o(e+"/teams/"+i.id,a,"PATCH",(function(e){"function"==typeof s&&s(e)}))}(0,i,(function(e){null!=e.responseText&&""!=e.responseText&&null!=e.responseText&&"undefined"!=e.responseText||postResult({isSuccessful:!0})}))}(0,l);break;case"list":!function(t,i){!function(t,i,s){if(null==t.displayNameStartsWith||""==t.displayNameStartsWith){var a=e+"/groups"+"?$select=id,displayName,resourceProvisioningOptions"}else{let i=t.displayNameStartsWith;if("string"!=typeof i)throw new Error("parameters[TeamDisplayNameStartsWith] is not of type string");let s="?$filter=startswith(displayName, '"+encodeURIComponent(i)+"')&$select=id,displayName,resourceProvisioningOptions";a=e+"/groups"+s}o(a,null,"GET",(function(e){"function"==typeof s&&s(e)}))}(t,0,(function(e){postResult(e.value.map(e=>({id:e.id,displayName:e.displayName,resourceProvisioningOptions:e.resourceProvisioningOptions[0]})))}))}(p);break;case"archive":!function(t,i){!function(t,i,s){var a=JSON.stringify({shouldSetSpoSiteReadOnlyForMembers:!0});let n=i.id;if("string"!=typeof n)throw new Error("properties[TeamId] is not of type string");o(e+"/teams/"+encodeURIComponent(n)+"/archive",a,"POST",(function(e){"function"==typeof s&&s(e)}))}(0,i,(function(e){postResult({id:i.id,requestStatusUrl:i.requestStatusUrl,isSuccessful:i.isSuccessful})}))}(0,l);break;case"unarchive":!function(t,i){!function(t,i,s){let a=i.id;if("string"!=typeof a)throw new Error("properties[TeamId] is not of type string");o(e+"/teams/"+encodeURIComponent(a)+"/unarchive",null,"POST",(function(e){"function"==typeof s&&s(e)}))}(0,i,(function(e){r(t,i),postResult({id:i.id,requestStatusUrl:i.requestStatusUrl,isSuccessful:i.isSuccessful})}))}(p,l);break;case"addMember":!function(e,t){s(e,t,(function(i){t.userPrincipalName=i.userPrincipalName,t.userId=i.id,n(e,t,(function(e){null!=e.responseText&&""!=e.responseText&&null!=e.responseText&&"undefined"!=e.responseText||postResult({isSuccessful:!0})}))}))}(p,l);break;case"removeMember":!function(t,i){s(t,i,(function(t){i.userId=t.id,i.userPrincipalName=t.userPrincipalName,function(t,i,s){let a=i.id;if("string"!=typeof a)throw new Error("properties[TeamId] is not of type string");let n=i.userId;if("string"!=typeof n)throw new Error("properties[TeamUserId] is not of type string");o(e+"/groups/"+encodeURIComponent(a)+"/members/"+encodeURIComponent(n)+"/$ref",null,"DELETE",(function(e){"function"==typeof s&&s(e)}))}(0,i,(function(e){null!=e.responseText&&""!=e.responseText&&null!=e.responseText&&"undefined"!=e.responseText||postResult({isSuccessful:!0})}))}))}(p,l);break;case"clone":!function(t,i){!function(t,i,s){var a=JSON.stringify({displayName:i.displayName,description:i.description,mailNickname:i.mailNickname,partsToClone:"apps,tabs,settings,channels,members",visibility:"public"});let n=i.id;if("string"!=typeof n)throw new Error("properties[TeamId] is not of type string");o(e+"/teams/"+encodeURIComponent(n)+"/clone",a,"POST",(function(e){"function"==typeof s&&s(e)}))}(0,i,(function(e){postResult({id:i.id,requestStatusUrl:i.requestStatusUrl,isSuccessful:i.isSuccessful})}))}(0,l);break;case"addOwner":!function(e,t){s(e,t,(function(i){t.userId=i.id,t.userPrincipalName=i.userPrincipalName,a(e,t,(function(e){null!=e.responseText&&""!=e.responseText&&null!=e.responseText&&"undefined"!=e.responseText||postResult({isSuccessful:!0})}))}))}(p,l);break;case"myTeamsList":d=function(e){postResult(e.value.map(e=>({id:e.id,displayName:e.displayName,description:e.description,isArchived:e.isArchived})))},o(e+"/me/joinedTeams",null,"GET",(function(e){"function"==typeof d&&d(e)}));break;case"checkStatus":!function(t,i){!function(t,i,s){let a=t.archiveOperationUrl;if("string"!=typeof a)throw new Error("parameters[TeamArchiveOperationUrl] is not of type string");o(e+"/"+encodeURIComponent(a),null,"GET",(function(e){"function"==typeof s&&s(e)}))}(t,0,(function(e){postResult({operationId:e.id,operationType:e.operationType,creationDate:e.createdDateTime,archiveStatus:e.status,lastActionDate:e.lastActionDateTime,attemptsCount:e.attemptsCount,targetResourceId:e.targetResourceId,targetResourceLocation:e.targetResourceLocation,archiveError:e.error})}))}(p);break;default:throw new Error("The method "+t+" is not supported..")}var d}(m,u,f);break;case"channel":!function(i,s,a){null==a&&null==s||(null==a&&null!==s?s.isSuccessful=!0:a.isSuccessful=!0);switch(i){case"get":!function(t,i){i.isSuccessful=!0,function(t,i,s){let a=i.teamId;if("string"!=typeof a)throw new Error("properties[ChannelTeamId] is not of type string");let n=i.id;if("string"!=typeof n)throw new Error("properties[ChannelId] is not of type string");o(e+"/teams/"+encodeURIComponent(a)+"/channels/"+encodeURIComponent(n),null,"GET",(function(e){"function"==typeof s&&s(e)}))}(0,i,(function(e){i.id=e.id,i.displayName=e.displayName,i.description=e.description,i.email=e.email,i.weburl=e.webUrl,p(t,i)}))}(s,a);break;case"list":!function(t,i){!function(t,i,s){let a=i.teamId;if("string"!=typeof a)throw new Error("properties[ChannelTeamId] is not of type string");o(e+"/teams/"+encodeURIComponent(a)+"/channels?$select=id, displayname, description, email",null,"GET",(function(e){"function"==typeof s&&s(e)}))}(0,i,(function(e){postResult(e.value.map(e=>({id:e.id,displayName:e.displayName,description:e.description,email:e.email})))}))}(0,a);break;case"create":!function(t,i){!function(t,i,s){var a=JSON.stringify({displayName:i.displayName,description:i.description,membershipType:i.membershipType});let n=i.teamId;if("string"!=typeof n)throw new Error("properties[ChannelTeamId] is not of type string");o(e+"/teams/"+encodeURIComponent(n)+"/channels",a,"POST",(function(e){"function"==typeof s&&s(e)}))}(0,i,(function(e){i.id=e.id,i.displayName=e.displayName,i.description=e.description,i.email=e.email,i.weburl=e.webUrl,p(t,i)}))}(s,a);break;case"delete":!function(t,i){!function(t,i,s){let a=i.teamId;if("string"!=typeof a)throw new Error("properties[ChannelTeamId] is not of type string");let n=i.id;if("string"!=typeof n)throw new Error("properties[ChannelId] is not of type string");o(e+"/teams/"+encodeURIComponent(a)+"/channels/"+encodeURIComponent(n),null,"DELETE",(function(e){"function"==typeof s&&s(e)}))}(0,i,(function(e){postResult({isSuccessful:!0})}))}(0,a);break;case"update":!function(t,i){!function(t,i,s){var a=JSON.stringify({displayName:i.displayName,description:i.description});let n=i.teamId;if("string"!=typeof n)throw new Error("properties[ChannelTeamId] is not of type string");let r=i.id;if("string"!=typeof r)throw new Error("properties[ChannelId] is not of type string");o(e+"/teams/"+encodeURIComponent(n)+"/channels/"+encodeURIComponent(r),a,"PATCH",(function(e){"function"==typeof s&&s(e)}))}(0,i,(function(e){i.id=e.id,i.displayName=e.displayName,i.description=e.description,i.email=e.email,i.weburl=e.webUrl,postResult({isSuccessful:!0})}))}(0,a);break;case"addMember":!function(i,s){!function(t,i,s){let a=i.userPrincipalName;if("string"!=typeof a)throw new Error("properties[ChannelUserPrincipalName] is not of type string");o(e+"/users/"+encodeURIComponent(a),null,"GET",(function(e){"function"==typeof s&&s(e)}))}(0,s,(function(i){s.userPrincipalName=i.userPrincipalName,s.userId=i.id,function(i,s,a){var n=JSON.stringify({"@odata.type":"#microsoft.graph.aadUserConversationMember",roles:[],"user@odata.bind":e+"/users('"+s.userId+"')"});let r=s.teamId,p=s.id;if("string"!=typeof r)throw new Error("properties[ChannelTeamId] is not of type string");if("string"!=typeof p)throw new Error("properties[ChannelId] is not of type string");o(t+"/teams/"+encodeURIComponent(r)+"/channels/"+encodeURIComponent(p)+"/members",n,"POST",(function(e){"function"==typeof a&&a(e)}))}(0,s,(function(e){null!=e.responseText&&""!=e.responseText&&null!=e.responseText&&"undefined"!=e.responseText||postResult({isSuccessful:!0})}))}))}(0,a);break;case"sendMessage":!function(i,s){!function(i,s,a){if(s.messageBody.toString().indexOf("<at")>-1)!function(t){o(e+"/users",null,"GET",(function(e){"function"==typeof t&&t(e)}))}((function(e){var i="true"==s.messageIsImportant?"High":"Normal",n={subject:s.messageSubject,importance:i.toString(),body:{contentType:"html",content:s.messageBody},mentions:[]};s.messageBody.toString().indexOf("<at")>-1&&(n.mentions=function(e,t,i){var s=[],a=i.value,n=t.match(/<at[^>]*>.*?<\/at>/gm);for(let e=0;e<n.length;e++){var o=n[e].replace(/<[^>]+>/g,""),r=a.filter((function(e){return e.displayName==o})),p={id:e,mentionText:o,mentioned:{application:null,device:null,conversation:null,user:{id:r[0].id,displayName:o,userIdentityType:"aadUser"}}};s.push(p)}return s}(0,s.messageBody,e));var r=JSON.stringify(n);let p=s.teamId;if("string"!=typeof p)throw new Error("properties[ChannelTeamId] is not of type string");let l=s.id;if("string"!=typeof l)throw new Error("properties[ChannelId] is not of type string");o(t+"/teams/"+encodeURIComponent(p)+"/channels/"+encodeURIComponent(l)+"/messages",r,"POST",(function(e){"function"==typeof a&&a(e)}))}));else{var n="true"==s.messageIsImportant?"High":"Normal",r=JSON.stringify({subject:s.messageSubject,importance:n.toString(),body:{contentType:"html",content:s.messageBody}});let e=s.teamId;if("string"!=typeof e)throw new Error("properties[ChannelTeamId] is not of type string");let i=s.id;if("string"!=typeof i)throw new Error("properties[ChannelId] is not of type string");o(t+"/teams/"+encodeURIComponent(e)+"/channels/"+encodeURIComponent(i)+"/messages",r,"POST",(function(e){"function"==typeof a&&a(e)}))}}(0,s,(function(e){postResult({isSuccessful:!0,messageId:e.id})}))}(0,a);break;case"replyMessage":!function(e,i){!function(e,i,s){var a=JSON.stringify({body:{contentType:"html",content:i.messageBody}});let n=i.teamId;if("string"!=typeof n)throw new Error("properties[ChannelTeamId] is not of type string");let r=i.id;if("string"!=typeof r)throw new Error("properties[ChannelId] is not of type string");let p=i.messageId;if("string"!=typeof p)throw new Error("properties[ChannelMessageId] is not of type string");o(t+"/teams/"+encodeURIComponent(n)+"/channels/"+encodeURIComponent(r)+"/messages/"+ +encodeURIComponent(p)+"/replies",a,"POST",(function(e){"function"==typeof s&&s(e)}))}(0,i,(function(e){postResult({isSuccessful:!0})}))}(0,a);break;case"sendAdaptiveCard":!function(e,i){!function(e,i,s){let a=i.teamId;if("string"!=typeof a)throw new Error("properties[ChannelTeamId] is not of type string");let n=i.id;if("string"!=typeof n)throw new Error("properties[ChannelId] is not of type string");var r=JSON.stringify({subject:null,body:{contentType:"html",content:'<attachment id="74d20c7f34aa4a7fb74e2b30004247c5"></attachment>'},attachments:[{id:"74d20c7f34aa4a7fb74e2b30004247c5",contentType:"application/vnd.microsoft.card.adaptive",content:i.messageBody.toString()}]});o(t+"/teams/"+encodeURIComponent(a)+"/channels/"+encodeURIComponent(n)+"/messages",r,"POST",(function(e){"function"==typeof s&&s(e)}))}(0,i,(function(e){postResult({isSuccessful:!0,messageId:e.id})}))}(0,a);break;case"getMessages":!function(e,i){!function(e,i,s){let a=i.teamId;if("string"!=typeof a)throw new Error("properties[ChannelTeamId] is not of type string");let n=i.id;if("string"!=typeof n)throw new Error("properties[ChannelId] is not of type string");o(t+"/teams/"+encodeURIComponent(a)+"/channels/"+encodeURIComponent(n)+"/messages",null,"GET",(function(e){if("function"==typeof s){var t=e.value.map(e=>({id:e.id,message:l(e),user:e.from.user.displayName,date:e.createdDateTime}));s(t)}}))}(0,i,(function(e){postResult(e.map(e=>({messageId:e.id,messageBody:e.message,messageUser:e.user,messageDate:e.date})))}))}(0,a);break;case"getDrive":!function(t,i){!function(t,i,s){let a=i.teamId;if("string"!=typeof a)throw new Error("properties[ChannelTeamId] is not of type string");let n=i.id;if("string"!=typeof n)throw new Error("properties[ChannelId] is not of type string");o(e+"/teams/"+encodeURIComponent(a)+"/channels/"+encodeURIComponent(n)+"/filesFolder",null,"GET",(function(e){"function"==typeof s&&s(e)}))}(0,i,(function(e){postResult({channelDriveId:e.parentReference.driveId,channelDriveUrl:e.webUrl})}))}(0,a);break;default:throw new Error("The channel method "+i+" is not supported...")}}(m,u,f);break;case"tab":!function(t,i,s){null==s&&null==i||(null==s&&null!==i?i.isSuccessful=!0:s.isSuccessful=!0);switch(t){case"get":!function(t,i){!function(t,i,s){let a=i.teamId;if("string"!=typeof a)throw new Error("properties[TabTeamId] is not of type string");let n=i.channelId;if("string"!=typeof n)throw new Error("properties[TabChannelId] is not of type string");let r=i.id;if("string"!=typeof r)throw new Error("properties[TabId] is not of type string");o(e+"/teams/"+encodeURIComponent(a)+"/Channels/"+encodeURIComponent(n)+"/tabs/"+encodeURIComponent(r)+"?$expand=teamsApp",null,"GET",(function(e){"function"==typeof s&&s(e)}))}(0,i,(function(e){postResult({id:e.id,displayName:e.displayName,configEntityId:e.configuration.entityId,configContentUrl:e.configuration.contentUrl,configWebsiteUrl:e.configuration.websiteUrl,configRemoveUrl:e.configuration.removeUrl,teamsAppAppId:e.teamsApp.id,teamsAppExternalId:e.teamsApp.externalId,teamsAppAppDisplayName:e.teamsApp.displayName,teamsAppDistMethod:e.teamsApp.distributionMethod,sortOrderIndex:e.sortOrderIndex,weburl:e.webUrl})}))}(0,s);break;case"update":!function(t,i){!function(t,i,s){var a=JSON.stringify({displayName:i.displayName,contentUrl:i.configContentUrl,removeUrl:i.configRemoveUrl,websiteUrl:i.configWebsiteUrl});let n=i.teamId;if("string"!=typeof n)throw new Error("properties[TabTeamId] is not of type string");let r=i.channelId;if("string"!=typeof r)throw new Error("properties[TabChannelId] is not of type string");let p=i.id;if("string"!=typeof p)throw new Error("properties[TabId] is not of type string");o(e+"/teams/"+encodeURIComponent(n)+"/Channels/"+encodeURIComponent(r)+"/tabs/"+encodeURIComponent(p),a,"PATCH",(function(e){"function"==typeof s&&s(e)}))}(0,i,(function(e){postResult({isSuccessful:!0})}))}(0,s);break;case"list":!function(t,i){!function(t,i,s){let a=i.teamId;if("string"!=typeof a)throw new Error("properties[TabTeamId] is not of type string");let n=i.channelId;if("string"!=typeof n)throw new Error("properties[TabChannelId] is not of type string");o(e+"/teams/"+encodeURIComponent(a)+"/channels/"+encodeURIComponent(n)+"/tabs?$select=id,displayName,webUrl",null,"GET",(function(e){"function"==typeof s&&s(e)}))}(0,i,(function(e){postResult(e.value.map(e=>({id:e.id,displayName:e.displayName,weburl:e.webUrl})))}))}(0,s);break;case"delete":!function(t,i){!function(t,i,s){let a=i.teamId;if("string"!=typeof a)throw new Error("properties[TabTeamId] is not of type string");let n=i.channelId;if("string"!=typeof n)throw new Error("properties[TabChannelId] is not of type string");let r=i.id;if("string"!=typeof r)throw new Error("properties[TabId] is not of type string");o(e+"/teams/"+encodeURIComponent(a)+"/Channels/"+encodeURIComponent(n)+"/tabs/"+encodeURIComponent(r),null,"DELETE",(function(e){"function"==typeof s&&s(e)}))}(0,i,(function(e){null!=e&&""!=e||postResult({isSuccessful:!0})}))}(0,s);break;case"createWordTab":case"createExcelTab":case"createPowerPointTab":case"createPdfTab":case"createOneNoteTab":case"createPlannerTab":case"createSharePointTab":case"createMsFormsTab":case"createStreamTab":case"createWebsiteTab":case"createWikiTab":case"createPowerBiTab":case"createDocumentLibraryTab":case"createCustomTab":d(t,i,s);break;default:throw new Error("The method "+t+" is not supported..")}}(m,u,f);break;case"app":!function(t,i,s){switch(t){case"list":!function(t,i){!function(t,i,s){let a=i.teamId;if("string"!=typeof a)throw new Error("properties[AppTeamId] is not of type string");o(e+"/teams/"+encodeURIComponent(a)+"/installedApps?$expand=teamsAppDefinition",null,"GET",(function(e){"function"==typeof s&&s(e)}))}(0,i,(function(e){postResult(e.value.map(e=>({id:e.id,displayName:e.teamsAppDefinition.displayName,version:e.teamsAppDefinition.version,teamsAppDefinitionId:e.teamsAppDefinition.id,teamsAppId:e.teamsAppDefinition.teamsAppId})))}))}(0,s);break;default:throw new Error("The method "+t+" is not supported..")}}(m,0,f);break;case"token":!function(e,i,s){switch(e){case"setToken":!function(e,i){!function(e,i,s){let a=i.tokenLifeTime,n=i.displayName,r="true"==i.isOrganizationDefault.toString();if("string"!=typeof a)throw new Error("properties[TokenLifetime] is not of type string");if("string"!=typeof n)throw new Error("properties[TokenPolicyDisplayName] is not of type string");var p=JSON.stringify({definition:['{"TokenLifetimePolicy":{"Version":1,"AccessTokenLifetime":"'+a+'"}}'],displayName:n,isOrganizationDefault:r});o(t+"/policies/tokenLifetimePolicies",p,"POST",(function(e){"function"==typeof s&&s({TokenUpdateSuccess:!0})}))}(0,i,(function(e){postResult({updateSuccess:e.TokenUpdateSuccess})}))}(0,s);break;default:throw new Error("The method "+e+" is not supported..")}}(m,0,f);break;case"drive":!function(t,i,s){switch(t){case"driveGetChildren":!function(t,i){!function(t,i,s){let a=i.driveId;if("string"!=typeof a)throw new Error("properties[DriveId] is not of type string");let n=i.drivePath;if("string"!=typeof n)throw new Error("properties[DriveRelativePath] is not of type string");o(e+"/drives/"+encodeURIComponent(a)+"/root:/"+encodeURIComponent(n)+":/children",null,"GET",(function(e){"function"==typeof s&&s(e)}))}(0,i,(function(e){postResult(e.value.map(e=>({driveChildId:e.id,driveChildFileName:e.name,driveChildDownloadUrl:e["@microsoft.graph.downloadUrl"],driveChildWebUrl:e.webUrl,driveChildFileType:e.file.mimeType,driveChildFileCreatedDate:e.createdDateTime,driveChildFileCreatedBy:e.createdBy.user.displayName})))}))}(0,s);break;default:throw new Error("The method "+t+" is not supported..")}}(m,0,f);break;default:throw new Error("The object "+c+" is not supported.")}};let f=null;u("postSchema",(function(e){f=e,console.log("postSchema:"),console.log(f)})),u("postResult",(function(e){}));u("XMLHttpRequest",class{constructor(){this.recorder={},this.recorder.headers={}}open(e,t){this.recorder.opened={method:e,url:t}}setRequestHeader(e,t){this.recorder.headers[e]=t}send(e){const t=require("request");this.withCredentials&&this.setRequestHeader("Authorization","Bearer ");const i={method:this.recorder.opened.method,url:this.recorder.opened.url,headers:this.recorder.headers,body:e,strictSSL:!1};new Promise((e,s)=>{try{t(i,(t,i,s)=>{t?console.error("error inside request:"+t):(this.responseText=s,this.readyState=4,this.status=i.statusCode,this.onreadystatechange(),e(s),delete this.responseText)})}catch(e){console.log("error ouside request "+e),s()}}).catch(e=>{console.log("Promise error:"+e)})}}),onexecute({objectName:"drive",methodName:"driveGetChildren",properties:{driveId:"b!liodivvnrU-bPFrG3o3bbi7jqbPXfwNMpXRs9nQguBPg5GIl5jhySrx21t1R0Dbs",drivePath:"Recordings"},parameters:{},configuration:{},schema:{}})}();
//# sourceMappingURL=run.js.map
